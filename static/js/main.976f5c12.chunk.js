(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{142:function(e,t,n){},186:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(21),r=n(356),i=n.n(r),s=n(357),c=n.n(s),o=n(0),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=Object(o.useState)(e),r=Object(a.a)(n,2),s=r[0],l=r[1],u=function(e){return l((function(n){return c()(n,e,t)}))},d=function(e){return l((function(n){return i()(n,e,t)}))},h=function(){return l([])};return[s,u,d,h]}},280:function(e,t,n){"use strict";(function(e){var a=n(30),r=n(31),i=n(24),s=n(37),c=n(36),o=n(0),l=n.n(o),u=(n(53),n(142),n(141)),d=n(48),h=n(47),m=n(87),f=n(643),p=n(646),E=n(647),v=n(648),g=n(649),b=n(650),y=n(651),C=n(652),T=n(653),_=n(654),S=n(279),O=n(655),k=n(278),A=n(371),B=n(51),P=n(8),I=n(29),w=n(34),j=u.a.Content,R=u.a.Footer,x=u.a.Sider,N=function(t){Object(s.a)(o,t);var n=Object(c.a)(o);function o(e){var t;Object(a.a)(this,o),t=n.call(this,e);var r=new URLSearchParams(window.location.search).get("keyring");return t.state={name:P.constants.DEFAULT_APP_NAME,menuItem:"menu-landing",session:null,collapsed:!1,error:{msg:null,cb:null},loading:!1,pendingMsg:null,waiting:!1,onCancel:null,deviceID:null,password:null,lastUpdated:new Date,windowWidth:window.innerWidth,walletIsExternal:null,keyringName:r,openedByKeyring:!!r,hwCheck:null},t.handleMenuChange=t.handleMenuChange.bind(Object(i.a)(t)),t.handleLogout=t.handleLogout.bind(Object(i.a)(t)),t.handleKeyringOpener=t.handleKeyringOpener.bind(Object(i.a)(t)),t.syncActiveWalletState=t.syncActiveWalletState.bind(Object(i.a)(t)),t.cancelConnect=t.cancelConnect.bind(Object(i.a)(t)),t.connectSession=t.connectSession.bind(Object(i.a)(t)),t.handlePair=t.handlePair.bind(Object(i.a)(t)),t.fetchBtcData=t.fetchBtcData.bind(Object(i.a)(t)),t.setError=t.setError.bind(Object(i.a)(t)),t.refreshWallets=t.refreshWallets.bind(Object(i.a)(t)),t.handlePageTurn=t.handlePageTurn.bind(Object(i.a)(t)),t.retry=t.retry.bind(Object(i.a)(t)),t.updateWidth=t.updateWidth.bind(Object(i.a)(t)),t}return Object(r.a)(o,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.updateWidth),this.isMobile()&&this.setState({collapsed:!0});var t=new URLSearchParams(window.location.search),n=this.state.keyringName,a=t.get("hwCheck"),r=t.get("forceLogin");if(t.get("loginCache"))this.setState({waiting:!0,pendingMsg:"Connecting..."});else if(n)window.onload=this.handleKeyringOpener(),this.setState({keyringName:n},(function(){var t=I.a.getKeyringItem(n),a=(new Date).getTime()-P.constants.KEYRING_LOGOUT_MS;!r&&t&&t.lastLogin>a?e.connect(t.deviceID,t.password,(function(){return e.connectSession(t)})):I.a.removeKeyringItem(n)}));else if(a)this.setState({hwCheck:a});else{var i=I.a.getLogin(),s=i.deviceID,c=i.password;s&&c&&this.connect(s,c,(function(){return e.connectSession()}))}}},{key:"componentDidUpdate",value:function(){this.context.session&&this.syncActiveWalletState()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWidth)}},{key:"updateWidth",value:function(){this.setState({windowWidth:window.innerWidth}),this.isMobile()&&!this.state.collapsed?this.setState({collapsed:!0}):!this.isMobile()&&this.state.collapsed&&this.setState({collapsed:!1})}},{key:"isMobile",value:function(){return this.context.isMobile}},{key:"connect",value:function(e,t,n){var a={deviceID:e,password:t},r=this.state.keyringName?this.state.keyringName:this.state.name;if(!this.context.session){var i=I.a.getSettings();this.context.setSession(new A.a(e,this.setError,r,i))}this.setState(a,n)}},{key:"cancelConnect",value:function(){this.context.session&&this.context.session.client&&this.context.session.client.pair("",(function(){})),this.setState({deviceID:null,password:null,session:null}),this.unwait()}},{key:"isConnected",value:function(){return!!this.context.session&&this.context.session.isConnected()}},{key:"handleKeyringOpener",value:function(){this.setState({openedByKeyring:!0})}},{key:"returnKeyringData",value:function(){if(this.state.openedByKeyring){I.a.setKeyringItem(this.state.keyringName,{deviceID:this.state.deviceID,password:this.state.password,lastLogin:(new Date).getTime()});var t={deviceID:this.state.deviceID,password:this.state.password,endpoint:P.constants.BASE_SIGNING_URL},n=I.a.getSettings();if(n.customEndpoint&&""!==n.customEndpoint&&(t.endpoint=n.customEndpoint),this.handleLogout(),window.opener)window.opener.postMessage(JSON.stringify(t),"*"),window.close();else{var a=e.from(JSON.stringify(t)).toString("base64");window.location.href="".concat(window.location.href,"&").concat("loginCache","=").concat(a)}}}},{key:"wait",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.setState({pendingMsg:e,waiting:!0,onCancel:t})}},{key:"unwait",value:function(){this.setState({pendingMsg:null,waiting:!1,onCancel:null})}},{key:"handlePageTurn",value:function(e){this.context.session.setPage(e)}},{key:"handleMenuChange",value:function(e){var t={menuItem:e.key};this.isMobile()&&(t.collapsed=!0),this.setState(t)}},{key:"handleLogout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.unwait(),this.context.session.disconnect(),this.setState({session:null}),I.a.removeLogin(),e&&e===P.constants.LOST_PAIRING_MSG&&this.setError({err:e})}},{key:"setError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{msg:null,cb:null};if(e.msg===P.constants.LOST_PAIRING_ERR)return this.handleLostPairing();this.setState({error:e,loading:!1})}},{key:"connectSession",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t.deviceID,r=t.password;if(!a||!r)return this.setError({msg:"You must provide a deviceID and password. Please refresh and log in again. "});this.setError(),this.connect(a,r,(function(){!0===n&&e.wait("Looking for your Lattice",e.cancelConnect),e.context.session.connect(a,r,(function(n,i){if(e.unwait(),e.context.session&&e.state.deviceID===a)if(n)e.setError({msg:n,cb:function(){e.connectSession(t)}});else if(e.state.openedByKeyring||I.a.setLogin({deviceID:a,password:r}),e.setError(),i&&e.state.openedByKeyring)return e.returnKeyringData()}))}))}},{key:"fetchBtcData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.unwait(),this.setError(),this.wait("Fetching addresses"),this.context.session.fetchBtcAddresses((function(n,a){if(n)return console.error("Error fetching BTC addresses",n),e.unwait(),void e.setError({msg:"Failed to fetch BTC addresses. Please try again.",cb:e.fetchBtcData});if(e.unwait(),!(t&&0===a.regular&&0===a.change)){t||e.context.session.clearUtxos(),e.wait("Syncing chain data");var r=t?a:null;e.context.session.fetchBtcStateData(r,(function(t){if(t)return console.error("Error fetching BTC state data",t),e.unwait(),void e.setError({msg:"Failed to fetch BTC state data. Please try again.",cb:e.fetchBtcData});e.fetchBtcData(!0)}))}}))}},{key:"handleLostPairing",value:function(){var e=this;this.context.session.client.pair("x",(function(){e.handleLogout(P.constants.LOST_PAIRING_MSG)}))}},{key:"refreshWallets",value:function(){var e=this;!0!==this.state.waiting&&(this.wait("Refreshing wallets"),this.setState({waiting:!0}),this.context.session.refreshWallets((function(t){return t===P.constants.LOST_PAIRING_ERR?e.handleLostPairing():(e.syncActiveWalletState(!0),e.unwait(),t?e.setError({msg:t,cb:e.refreshWallets}):(e.setError(),void(P.constants.BTC_PURPOSE_NONE!==Object(P.getBtcPurpose)()&&e.fetchBtcData())))})))}},{key:"syncActiveWalletState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.context.session.getActiveWallet();if(t){var n=t.external;if(this.state.walletIsExternal!==n){var a=null!==this.state.walletIsExternal;this.setState({walletIsExternal:n}),!0===a&&!0!==e&&this.refreshWallets()}}}},{key:"handlePair",value:function(e){var t=this;"_"!==e[0]&&"["!==e[0]||(e=e.slice(1)),this.wait("Establishing connection with your Lattice"),this.context.session.client.pair(e,(function(e){if(t.unwait(),e){t.setError({msg:"Failed to pair. You either entered the wrong code or have already connected to this app.",cb:t.connectSession})}else t.state.openedByKeyring&&t.returnKeyringData()}))}},{key:"renderMenu",value:function(){var e=P.constants.BTC_PURPOSE_NONE===Object(P.getBtcPurpose)();return l.a.createElement(x,{collapsed:this.state.collapsed,collapsedWidth:0},l.a.createElement(d.a,{theme:"dark",mode:"inline",onSelect:this.handleMenuChange},l.a.createElement(d.a.Item,{key:"menu-landing",title:null},l.a.createElement(E.a,null),l.a.createElement("span",null,"Home")),l.a.createElement(d.a.Item,{key:"menu-kv-records",title:null},l.a.createElement(v.a,null),l.a.createElement("span",null,"Address Tags")),l.a.createElement(d.a.Item,{key:"menu-eth-contracts",title:null},l.a.createElement(g.a,null),l.a.createElement("span",null,"Contracts")),l.a.createElement(d.a.Item,{key:"menu-settings",title:null},l.a.createElement(b.a,null),l.a.createElement("span",null,"Settings")),e?null:l.a.createElement(d.a.SubMenu,{title:"BTC Wallet",key:"submenu-wallet"},l.a.createElement(d.a.Item,{key:"menu-wallet",title:null},l.a.createElement(y.a,null),l.a.createElement("span",null,"History")),l.a.createElement(d.a.Item,{key:"menu-send",title:null},l.a.createElement(C.a,null),l.a.createElement("span",null,"Send")),l.a.createElement(d.a.Item,{key:"menu-receive",title:null},l.a.createElement(T.a,null),l.a.createElement("span",null,"Receive")))))}},{key:"renderSidebar",value:function(){if(this.state.name===P.constants.DEFAULT_APP_NAME)return this.isConnected()?this.renderMenu():void 0}},{key:"renderHeaderText",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,this.isMobile()?l.a.createElement(h.a,{onClick:function(){return e.setState({collapsed:!e.state.collapsed})},type:"text",size:"large",icon:l.a.createElement(_.a,null),style:{backgroundColor:"transparent",marginRight:"5px"}}):null,l.a.createElement("a",{className:"lattice-a",href:"https://gridplus.io",target:"_blank",rel:"noopener noreferrer"},l.a.createElement("img",{alt:"GridPlus",src:"/gridplus-logo.png",style:{height:"1em"}})))}},{key:"renderHeader",value:function(){if(this.state.name===P.constants.DEFAULT_APP_NAME){var e=[];if(this.isConnected()){var t=null,n=this.isMobile()?"small":"middle",a=this.context.session.getActiveWallet();return(t=null===a?l.a.createElement(h.a,{type:"danger",ghost:!0,onClick:this.refreshWallets,size:n},"No Wallet ",l.a.createElement(S.a,null)):!0===a.external?l.a.createElement(h.a,{type:"primary",ghost:!0,onClick:this.refreshWallets,size:n},l.a.createElement(O.a,null)," SafeCard ",l.a.createElement(S.a,null)):l.a.createElement(h.a,{type:"default",ghost:!0,onClick:this.refreshWallets,size:n},l.a.createElement(k.a,null)," Lattice ",l.a.createElement(S.a,null)))&&e.push(l.a.createElement(m.a,{title:"Refresh",key:"WalletTagTooltip"},t)),e.push(l.a.createElement(h.a,{key:"logout-button",type:"primary",onClick:this.handleLogout,size:n},"Logout")),l.a.createElement(f.a,{title:this.renderHeaderText(),ghost:!0,extra:this.state.waiting?null:e})}}}},{key:"renderErrorHeader",value:function(){if(this.state.error.msg){var e=l.a.createElement(B.c,{msg:this.state.error.msg,retryCb:this.state.error.cb});return l.a.createElement(B.h,{content:e})}}},{key:"retry",value:function(e){return this.setError(),e()}},{key:"renderMenuItem",value:function(){switch(this.state.menuItem){case"menu-wallet":return l.a.createElement(B.n,{session:this.context.session,refreshData:this.fetchBtcData,lastUpdated:this.state.lastUpdated,pageTurnCb:this.handlePageTurn});case"menu-receive":return l.a.createElement(B.j,{session:this.context.session});case"menu-send":return l.a.createElement(B.k,{session:this.context.session});case"menu-eth-contracts":return l.a.createElement(B.d,null);case"menu-settings":return l.a.createElement(B.l,null);case"menu-kv-records":return l.a.createElement(B.a,null);case"menu-landing":return l.a.createElement(B.e,null);default:return}}},{key:"renderContent",value:function(){var e=this,t=!!this.context.session&&null!==this.context.session.getActiveWallet();if(this.state.waiting)return l.a.createElement(B.f,{msg:this.state.pendingMsg,onCancel:this.state.onCancel});if(this.isConnected()){if(this.context.session.isPaired()){if(this.state.openedByKeyring)return l.a.createElement(B.f,{msg:"Successfully connected to your Lattice! You may close this window.",spin:!1});if(t)return this.renderMenuItem();var n=this.context.session?this.refreshWallets:null;return l.a.createElement(B.c,{msg:"No active wallet present for device!",retryCb:n})}return l.a.createElement(B.i,{submit:this.handlePair,hide:!!this.state.error.msg})}return l.a.createElement(B.b,{submitCb:this.connectSession,cancelConnect:this.cancelConnect,name:this.state.name,keyringName:this.state.keyringName,setKeyringName:function(t){return e.setState({keyringName:t})},errMsg:this.state.error.msg})}},{key:"renderFooter",value:function(){return l.a.createElement(R,{style:{textAlign:"center"}},"\xa92021 GridPlus Inc","dev"===P.constants.ENV?l.a.createElement(p.a,{color:"blue",style:{margin:"0 0 0 10px"}},"DEV"):null)}},{key:"renderPage",value:function(){return null!==this.state.hwCheck?l.a.createElement(B.m,{data:this.state.hwCheck}):this.renderContent()}},{key:"render",value:function(){return l.a.createElement(u.a,{style:{minHeight:"100vh"}},this.renderHeader(),l.a.createElement(u.a,{id:"main-content-outer"},this.renderSidebar(),l.a.createElement(u.a,{id:"main-content-inner"},l.a.createElement(j,{style:{margin:"0 0 0 0"}},this.renderErrorHeader(),l.a.createElement("div",{style:{margin:"30px 0 0 0"}},this.renderPage())),this.renderFooter())))}}]),o}(l.a.Component);N.contextType=w.a,t.a=N}).call(this,n(20).Buffer)},29:function(e,t,n){"use strict";var a=n(78),r=n(60),i=n(138),s=n.n(i),c=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_ROOT_STORE||"gridplus",o=function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(n){return JSON.parse(JSON.stringify(t))}},l=function(e,t){return window.localStorage.setItem(e,JSON.stringify(t))},u=function(e){return window.localStorage.removeItem(e)},d=function(){var e;return null!==(e=o(c))&&void 0!==e?e:{}},h=function(e){var t,n;return null!==(t=null===(n=o(c))||void 0===n?void 0:n[e])&&void 0!==t?t:{}},m=function(e,t){return window.localStorage.setItem(c,JSON.stringify(Object(r.a)(Object(r.a)({},d()),{},Object(a.a)({},"".concat(e),t))))},f=function(){return h("keyring")},p=function(e){var t,n;return null!==(t=null===(n=h("keyring"))||void 0===n?void 0:n[e])&&void 0!==t?t:{}},E=function(e,t){return m("keyring",Object(a.a)({},"".concat(e),t))},v=function(e){return m("keyring",s()(f(),e))},g=function(){return o("gridplus_web_wallet_id")},b=function(e){return l("gridplus_web_wallet_id",e)},y=function(){return u("gridplus_web_wallet_id")},C=function(){return o("gridplus_web_wallet_password")},T=function(e){return l("gridplus_web_wallet_password",e)},_=function(){return u("gridplus_web_wallet_password")},S=function(e){var t,n=g();if(n)return null===(t=h(n))||void 0===t?void 0:t[e]},O=function(e,t){var n=g();if(n&&t)return m(n,Object(r.a)(Object(r.a)({},h(n)),{},Object(a.a)({},"".concat(e),t)))},k=function(e){var t=g();if(t)return m(t,s()(h(t),e))};t.a={getItem:o,setItem:l,removeItem:u,getRootStore:d,setRootStore:function(e){return window.localStorage.setItem(c,JSON.stringify(Object(r.a)(Object(r.a)({},d()),e)))},removeRootStore:function(){return u(c)},getRootStoreItem:h,setRootStoreItem:m,removeRootStoreItem:function(e){return window.localStorage.setItem(c,JSON.stringify(s()(d(),e)))},getSettings:function(){return h("settings")},setSettings:function(e){return m("settings",e)},getLoginId:g,setLoginId:b,removeLoginId:y,getLoginPassword:C,setLoginPassword:T,removeLoginPassword:_,getKeyring:f,setKeyring:function(e){return m("keyring",e)},getKeyringItem:p,setKeyringItem:E,removeKeyringItem:v,renameKeyringItem:function(e,t){if(e!==t){var n=Object(r.a)({},p(e));E(t,n),v(e)}},getLogin:function(){return{deviceID:g(),password:C()}},setLogin:function(e){var t=e.deviceID,n=e.password;b(t),T(n)},removeLogin:function(){y(),_()},getDeviceIndexedItem:S,setDeviceIndexedItem:O,removeDeviceIndexedItem:k,getAddresses:function(){return S("gridplus_addresses")},setAddresses:function(e){return O("gridplus_addresses",e)},removeAddresses:function(){return k("gridplus_addresses")},getContracts:function(){return S("gridplus_contracts")},setContracts:function(e){return O("gridplus_contracts",e)},removeContracts:function(){return k("gridplus_contracts")},getContractPacks:function(){var e;return null!==(e=o("gridplus_contracts_packs"))&&void 0!==e?e:[]},setContractPacks:function(e){return l("gridplus_contracts_packs",e)},removeContractPacks:function(){return u("gridplus_contracts_packs")}}},34:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(60),r=n(21),i=n(0),s=n.n(i),c=n(186),o=n(29),l=Object(i.createContext)(void 0),u=function(e){var t,n=e.children,u=e.overrides,d=Object(i.useState)(window.innerWidth<500),h=Object(r.a)(d,2),m=h[0],f=h[1],p=Object(i.useState)(null),E=Object(r.a)(p,2),v=E[0],g=E[1],b=Object(i.useState)(!1),y=Object(r.a)(b,2),C=y[0],T=y[1],_=Object(c.a)(null!==(t=o.a.getAddresses())&&void 0!==t?t:[]),S=Object(r.a)(_,4),O=S[0],k=S[1],A=S[2],B=S[3],P={isMobile:m,session:v,setSession:g,isLoadingAddresses:C,setIsLoadingAddresses:T,addresses:O,addAddressesToState:k,removeAddressesFromState:A,resetAddressesInState:B};return Object(i.useEffect)((function(){o.a.setAddresses(O)}),[O]),Object(i.useEffect)((function(){window.addEventListener("resize",(function(){var e=window.innerWidth<500;e&&!m&&f(!0),!e&&m&&f(!1)}))}),[m]),s.a.createElement(l.Provider,{value:Object(a.a)(Object(a.a)({},P),u)},n)}},350:function(e,t,n){"use strict";(function(e){var a=n(30),r=n(31),i=n(37),s=n(36),c=n(0),o=n.n(c),l=(n(53),n(644)),u=n(112),d=n(70),h=n(645),m=n(153),f=n(8),p=n(34),E=n(343).default,v=n(231).ec,g=function(t){Object(i.a)(c,t);var n=Object(s.a)(c);function c(){return Object(a.a)(this,c),n.apply(this,arguments)}return Object(r.a)(c,[{key:"_validate",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"secp256k1",r=new E,i=new v(a),s=r.createHash("sha256").update(e).digest(),c=i.keyFromPublic(t,"hex");return c.verify(s,n)}},{key:"getPreimage",value:function(){return Object(m.decode)(this.props.data).slice(0,32).toString()}},{key:"getCert",value:function(){var t=Object(m.decode)(this.props.data).slice(106,253),n=t.slice(2,73),a=e.from(t.slice(8,73)).toString("hex"),r=e.from(t.slice(73,147));return{pubkey:a,preimage:n,sig:r.slice(0,2+r[1])}}},{key:"validateCert",value:function(){var e=this.getCert();return this._validate(e.preimage,f.constants.LATTICE_CERT_SIGNER,e.sig)}},{key:"validateSig",value:function(){try{if(!this.validateCert())return!1;var t=this.getPreimage(),n=this.getCert(),a=e.from(Object(m.decode)(this.props.data).slice(32,106)),r=a.slice(0,2+a[1]);return this._validate(t,n.pubkey,r)}catch(i){return console.error("Encountered error validating signature: ".concat(i.message)),!1}}},{key:"renderResult",value:function(){var e={status:"warning",title:"Could not Verify Authenticity",subTitle:"We could not verify the authenticity of this signature or signer."};return!0===this.validateSig()&&(e.status="success",e.title="Verified",e.subTitle="The signer is authentic!"),o.a.createElement(l.a,{status:e.status,title:e.title,subTitle:e.subTitle})}},{key:"render",value:function(){var e=this.context.isMobile?18:10,t=this.context.isMobile?3:7;return o.a.createElement(u.a,null,o.a.createElement(d.a,{span:e,offset:t},o.a.createElement("center",null,o.a.createElement(h.a,{title:"Validate Hardware",bordered:!0},this.renderResult(),o.a.createElement("p",null,o.a.createElement("b",null,"Message:")," ",this.getPreimage())))))}}]),c}(o.a.Component);g.contextType=p.a,t.a=g}).call(this,n(20).Buffer)},371:function(e,t,n){"use strict";var a=n(78),r=n(30),i=n(31),s=n(184),c=n(8),o=n(29),l=function(){function e(t,n){Object(r.a)(this,e),this.data=void 0,this.store=void 0,this.data=null,this.store=o.a.getRootStore()}return Object(i.a)(e,[{key:"isObject",value:function(e){try{return e&&"object"===typeof e&&!Array.isArray(e)}catch(t){return!1}}},{key:"updateBranch",value:function(e,t,n){var a=this;this.isObject(t)&&(this.isObject(e[n])&&!t[n]&&(t[n]={}),this.isObject(e[n])?Object.keys(e[n]).forEach((function(r){a.isObject(e[n][r])?a.updateBranch(e[n],t[n],r):t[n][r]=e[n][r]})):t[n]=e[n])}},{key:"save",value:function(e,t,n){var a=this;this.store[e]||(this.store[e]={}),this.store[e][t]||(this.store[e][t]={}),Object.keys(n).forEach((function(r){a.updateBranch(n,a.store[e][t],r)})),o.a.setRootStore(this.store)}},{key:"getWalletData",value:function(e,t){return this.store[e]||(this.store[e]={}),this.store[e][t]||(this.store[e][t]={}),this.store[e][t]}}]),e}(),u=n(20).Buffer,d=n(343).default,h=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(r.a)(this,e),this.client=void 0,this.crypto=void 0,this.name=void 0,this.storageSession=void 0,this.deviceID=void 0,this.stateUpdateHandler=void 0,this.page=void 0,this.baseUrl=void 0,this.addresses=void 0,this.btcTxs=void 0,this.btcUtxos=void 0,this.lastFetchedBtcData=void 0,this.btcPrice=void 0,this.client=null,this.crypto=null,this.name=a||c.constants.DEFAULT_APP_NAME,this.storageSession=null,this.deviceID=t,this.stateUpdateHandler=n,this.page=1,this.baseUrl=i.customEndpoint?i.customEndpoint:c.constants.BASE_SIGNING_URL,this.addresses={},this.btcTxs=[],this.btcUtxos=[],this.lastFetchedBtcData=0,this.btcPrice=0,this.getBtcWalletData()}return Object(i.a)(e,[{key:"disconnect",value:function(){this.client=null,this.saveBtcWalletData(),this.storageSession=null,this.deviceID=null}},{key:"isConnected",value:function(){return null!==this.client}},{key:"isPaired",value:function(){return this.client.isPaired||!1}},{key:"resetStateData",value:function(){this.addresses={},this.btcTxs=[],this.btcUtxos=[]}},{key:"getBtcDisplayAddress",value:function(){var e=this._getLastUsedBtcAddrIdx();return e>-1&&this.addresses.BTC[e+1]?this.addresses.BTC[e+1]:this.addresses.BTC&&this.addresses.BTC.length>0?this.addresses.BTC[0]:null}},{key:"getActiveWallet",value:function(){return this.client?this.client.getActiveWallet():null}},{key:"setPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=e}},{key:"getPage",value:function(){return this.page}},{key:"dryAddresses",value:function(){var e={},t=this.addresses.BTC&&this.addresses.BTC.length>0,n=this.addresses.BTC_CHANGE&&this.addresses.BTC_CHANGE.length>0,a=Object(c.getBtcPurpose)();return a===c.constants.BTC_PURPOSE_NONE||(t&&(e.BTC={},e.BTC[a]=this.addresses.BTC||[]),n&&(e.BTC_CHANGE={},e.BTC_CHANGE[a]=this.addresses.BTC_CHANGE||[])),e}},{key:"rehydrateAddresses",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},n=Object(c.getBtcPurpose)();if(n===c.constants.BTC_PURPOSE_NONE)return t;e.BTC&&(t.BTC=e.BTC[n]),e.BTC_CHANGE&&(t.BTC_CHANGE=e.BTC_CHANGE[n]),this.addresses=t}},{key:"saveBtcWalletData",value:function(){var e;if(this.deviceID&&this.storageSession){var t=Object(c.getBtcPurpose)();if(t!==c.constants.BTC_PURPOSE_NONE){var n=Object(a.a)({},c.constants.BTC_WALLET_STORAGE_KEY,(e={},Object(a.a)(e,t,{addresses:this.dryAddresses(),btcTxs:this.btcTxs,btcUtxos:this.btcUtxos,lastFetchedBtcData:this.lastFetchedBtcData}),Object(a.a)(e,"btcPrice",this.btcPrice),e)),r=this.client?this.client.getActiveWallet():null;if(this.client&&null!==r){var i=r.uid.toString("hex");this.storageSession.save(this.deviceID,i,n)}}else console.error("Cannot save BTC wallet data when wallet is hidden")}}},{key:"getBtcWalletData",value:function(){if(this.deviceID&&!this.storageSession&&(this.storageSession=new l(this.deviceID)),this.client){var e=Object(c.getBtcPurpose)();if(e===c.constants.BTC_PURPOSE_NONE)return void console.error("Cannot get wallet data when wallet is hidden.");var t=this.getActiveWallet();if(null===t)this.addresses={};else{var n=t.uid.toString("hex"),a=this.storageSession.getWalletData(this.deviceID,n);if(!a||!a[c.constants.BTC_WALLET_STORAGE_KEY])return;var r=a[c.constants.BTC_WALLET_STORAGE_KEY];r.btcPrice&&(this.btcPrice=r.btcPrice);var i=r[e];if(!i)return;i.addresses&&this.rehydrateAddresses(i.addresses),i.btcTxs&&(this.btcTxs=i.btcTxs),i.btcUtxos&&(this.btcUtxos=i.btcUtxos),i.lastFetchedBtcData&&(this.lastFetchedBtcData=i.lastFetchedBtcData)}}}},{key:"_tryConnect",value:function(e,t,n){var a=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.baseUrl,o=c.constants.SHORT_TIMEOUT;!1===r&&(i="http://lattice-".concat(e,".local:8080"),o=5e3);var l,u=this._genPrivKey(e,t,this.name);try{l=new s.Client({name:this.name,privKey:u,baseUrl:i,timeout:o,skipRetryOnWrongWallet:!1})}catch(d){return n(d.toString())}l.connect(e,(function(i){return i?!1===r?(console.warn("Failed to connect to Lattice over LAN. Falling back to cloud routing."),a._tryConnect(e,t,n,!0)):(console.error("Failed to connect via cloud routing."),n(i)):(!1===r&&console.log("Successfully connected to Lattice over LAN."),l.timeout=c.constants.ASYNC_SDK_TIMEOUT,a.client=l,a.deviceID=e,a.getBtcWalletData(),n(null,l.isPaired))}))}},{key:"connect",value:function(e,t,n){return this._tryConnect(e,t,n,!0)}},{key:"refreshWallets",value:function(e){var t=this;if(!this.client)return e("Lost connection to Lattice. Please refresh.");var n=JSON.stringify(this.client.getActiveWallet());this.client.connect(this.deviceID,(function(a,r){return!1===t.client.isPaired?e(c.constants.LOST_PAIRING_ERR):a?e(a):(JSON.stringify(t.client.getActiveWallet())!==n&&t.resetStateData(),t.getBtcWalletData(),e(null,r))}))}},{key:"sign",value:function(e,t){this.client.sign(e,(function(e,n){if(e)return t(e);Object(c.broadcastBtcTx)(n.tx,(function(e,n){return e?t("Error broadcasting transaction: ".concat(e.message)):t(null,n)}))}))}},{key:"_genPrivKey",value:function(e,t,n){var a=u.concat([u.from(t),u.from(e),u.from(n)]);return this.crypto=new d(a),this.crypto.createHash("sha256").update(a).digest()}},{key:"getBtcTxs",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];return this.btcTxs.forEach((function(n){e&&n.confirmed?t.push(n):e||n.confirmed||t.push(n)})),t}},{key:"getBtcUtxos",value:function(){return this.btcUtxos}},{key:"getBtcBalance",value:function(){var e=0;return this.btcUtxos.forEach((function(t){e+=t.value})),e}},{key:"fetchBtcAddresses",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{regular:0,change:0},r=Object(c.getBtcPurpose)();if(r===c.constants.BTC_PURPOSE_NONE)return e("Cannot request BTC addresses while wallet is hidden.");var i=this._getLastUsedBtcAddrIdx(n),s=(n?this.addresses.BTC_CHANGE:this.addresses.BTC)||[],o=n?c.constants.BTC_CHANGE_GAP_LIMIT:c.constants.BTC_MAIN_GAP_LIMIT,l=i+1+o,u=l-s.length,d=Math.min(c.constants.BTC_ADDR_BLOCK_LEN,u);if(d>0){var h=n?1:0,m={startPath:[r,c.constants.BTC_COIN,Object(c.harden)(0),h,s.length],n:d,skipCache:!0};this._getAddresses(m,(function(r,i){if(r)return e(r);n?a.change+=d:a.regular+=d,n?t.addresses.BTC_CHANGE=s.concat(i):t.addresses.BTC=s.concat(i),console.log("Fetched BTC",t.addresses.BTC),console.log("Fetched BTC_CHANGE",t.addresses.BTC_CHANGE),u>d?t.fetchBtcAddresses(e,n,a):n?(t.saveBtcWalletData(),e(null,a)):t.fetchBtcAddresses(e,!0,a)}))}else n?(this.saveBtcWalletData(),e(null,a)):this.fetchBtcAddresses(e,!0,a)}},{key:"clearUtxos",value:function(){this.btcUtxos=[]}},{key:"fetchBtcStateData",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=(a?this.addresses.BTC_CHANGE:this.addresses.BTC)||[];e&&e.regular>0?(s=this.addresses.BTC.slice(-e.regular),e.regular=0):e&&e.change>0&&(a=!0,s=this.addresses.BTC_CHANGE.slice(-e.change),e.change=0),Object(c.fetchBtcPrice)((function(o,l){o&&(console.error("Failed to fetch price:",o),l=0),Object(c.fetchBtcTxs)(s,r,(function(o,u){return o?t(o):u?(r=r.concat(u),void Object(c.fetchBtcUtxos)(s,(function(s,o){if(s)return t(s);if(!o)return t("Failed to fetch UTXOs");if(i=i.concat(o),a){n.btcPrice=l,n.lastFetchedBtcData=Math.floor(Date.now());var u=n.btcTxs.concat(r);n.btcTxs=Object(c.filterUniqueObjects)(u,["id"]),n._processBtcTxs();var d=n.btcUtxos.concat(i);n.btcUtxos=Object(c.filterUniqueObjects)(d,["id","vout"]).sort((function(e,t){return t.value-e.value})),n.saveBtcWalletData(),t(null)}else n.fetchBtcStateData(e,t,!0,r,i)}))):t("Failed to fetch transactions")}))}))}},{key:"_getAddresses",value:function(e,t){var n=this;this.client.getAddresses(e,(function(a,r){if(!a||"Device Busy"===a)return"Device Busy"===a?n._getAddresses(e,t):t(null,r);setTimeout((function(){return t(a)}),2e3)}))}},{key:"_getLastUsedBtcAddrIdx",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?"BTC_CHANGE":"BTC",n=this.addresses[t]||[],a=this.btcTxs||[],r=-1,i=0;i<a.length;i++)a[i].confirmed&&function(){var e=r;a[i].inputs.forEach((function(t){n.indexOf(t.addr)>e&&(e=n.indexOf(t.addr))})),a[i].outputs.forEach((function(t){n.indexOf(t.addr)>e&&(e=n.indexOf(t.addr))})),e>r&&(r=e)}();return r}},{key:"_processBtcTxs",value:function(){var e=this.addresses.BTC.concat(this.addresses.BTC_CHANGE),t=[];JSON.parse(JSON.stringify(this.btcTxs)).forEach((function(n){if(n.incoming=n.inputs.every((function(t){return-1===e.indexOf(t.addr)})),n.incoming?(n.outputs.forEach((function(t){!n.recipient&&e.indexOf(t.addr)>-1&&(n.recipient=e[e.indexOf(t.addr)])})),n.recipient||(n.recipient=n.outputs[0].addr)):n.recipient=n.outputs[0].addr,n.value=0,n.incoming)n.outputs.forEach((function(t){e.indexOf(t.addr)>-1&&(n.value+=t.value)}));else{var a=0;n.inputs.forEach((function(e){a+=e.value}));var r=0,i=0;n.outputs.forEach((function(t){e.indexOf(t.addr)>-1?r+=t.value:i+=t.value})),a===r+n.fee?n.value=0:n.value=i}t.push(n)}));var n=t.sort((function(e,t){return t.timestamp-e.timestamp}));this.btcTxs=n}}]),e}();t.a=h},377:function(e,t,n){e.exports=n(642)},392:function(e,t){},394:function(e,t){},408:function(e,t){},410:function(e,t){},441:function(e,t){},452:function(e,t){},466:function(e,t){},51:function(e,t,n){"use strict";n.d(t,"g",(function(){return a.a})),n.d(t,"h",(function(){return f})),n.d(t,"b",(function(){return P})),n.d(t,"i",(function(){return w})),n.d(t,"d",(function(){return Be})),n.d(t,"l",(function(){return Me})),n.d(t,"a",(function(){return $e})),n.d(t,"e",(function(){return nt})),n.d(t,"f",(function(){return at})),n.d(t,"c",(function(){return rt})),n.d(t,"m",(function(){return it.a})),n.d(t,"n",(function(){return Et})),n.d(t,"j",(function(){return xt})),n.d(t,"k",(function(){return Bt}));var a=n(280),r=n(30),i=n(31),s=n(37),c=n(36),o=n(0),l=n.n(o),u=(n(53),n(112)),d=n(70),h=n(34),m=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){if(this.props.children||this.props.content)return this.context.isMobile?this.props.children?this.props.children:this.props.content:l.a.createElement(u.a,{justify:"center"},l.a.createElement(d.a,{span:14},this.props.children||this.props.content))}}]),n}(l.a.Component);m.contextType=h.a;var f=m,p=n(24),E=n(47),v=n(365),g=n(661),b=n(663),y=n(645),C=n(667),T=n(668),_=n(8),S=n(21),O=n(666),k=n(658),A=function(e){var t=e.name,n=e.setName,a=Object(o.useState)(!1),r=Object(S.a)(a,2),i=r[0],s=r[1],c=Object(o.useState)(!1),u=Object(S.a)(c,2),d=u[0],h=u[1],m=k.a.useForm(),f=Object(S.a)(m,1)[0];return i?l.a.createElement(k.a,{form:f,name:"formData",layout:"inline",onFinish:function(e){s(!1),n(e.name)},style:{justifyContent:"center"}},l.a.createElement(k.a.Item,{name:"name",initialValue:t,rules:[{required:!0,message:"Name is required."}]},l.a.createElement(v.a,{"data-testid":"".concat(t,"-input")})),l.a.createElement(k.a.Item,null,l.a.createElement(E.a,{type:"text",onClick:function(){f.resetFields(),s(!1)},"data-testid":"".concat(t,"-cancel")},"Cancel"),l.a.createElement(E.a,{type:"ghost",htmlType:"submit","data-testid":"".concat(t,"-save")},"Save"))):l.a.createElement(E.a,{type:"text",size:"large",icon:d?l.a.createElement(O.a,null):null,style:{fontSize:"24px"},"data-testid":"".concat(t,"-edit"),onClick:function(){return s(!0)},onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)}},t)},B=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={errMsg:null,isLoading:!1,modal:!1,showSettings:!1},a.handleCancel=a.handleCancel.bind(Object(p.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(p.a)(a)),a.renderMsg=a.renderMsg.bind(Object(p.a)(a)),a.showModal=a.showModal.bind(Object(p.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.input.focus(),this.setState({isLoading:!1})}},{key:"componentDidUpdate",value:function(){this.props.name!==_.constants.DEFAULT_APP_NAME&&"Lattice Connector"!==document.title&&(document.title="Lattice Connector")}},{key:"componentWillUnmount",value:function(){this.setState({isLoading:!1})}},{key:"handleSubmit",value:function(){var e=document.getElementById("deviceIdInput").value,t=document.getElementById("passwordInput").value;t.length<8?this.setState({isLoading:!0,errMsg:"Your password must be at least 8 characters."}):(this.setState({isLoading:!0,errMsg:null}),this.props.submitCb({deviceID:e,password:t},!1))}},{key:"handleCancel",value:function(){this.props.cancelConnect(),this.setState({isLoading:!1,errMsg:null})}},{key:"renderConnectButton",value:function(){return this.state.isLoading&&null===this.state.errMsg&&null===this.props.errMsg?l.a.createElement("div",null,l.a.createElement(E.a,{type:"primary",style:{margin:"20px 0 0 0"},loading:!0},"Connecting..."),l.a.createElement("br",null),l.a.createElement(E.a,{type:"link",onClick:this.handleCancel},"Cancel")):l.a.createElement(E.a,{type:"primary",onClick:this.handleSubmit,style:{margin:"20px 0 0 0"}},"Connect")}},{key:"renderForm",value:function(e){var t=this;return l.a.createElement("div",null,l.a.createElement(u.a,{justify:"center"},l.a.createElement(v.a,{placeholder:"DeviceID",id:"deviceIdInput",ref:function(e){t.input=e},style:{margin:"10px 0 0 0",width:"70%"}})),l.a.createElement(u.a,{justify:"center"},l.a.createElement(v.a.Password,{placeholder:"Password (create for new logins)",id:"passwordInput",onPressEnter:this.handleSubmit,style:{margin:"20px 0 0 0",width:"70%"}})),l.a.createElement(u.a,{justify:"center"},this.renderConnectButton()))}},{key:"showModal",value:function(){this.setState({modal:!0})}},{key:"hideModal",value:function(){this.setState({modal:!1,showSettings:!1})}},{key:"renderSetupInfo",value:function(){return l.a.createElement("div",null,l.a.createElement("center",null,l.a.createElement("h3",null,l.a.createElement("b",null,"New User Setup"))),l.a.createElement("p",null,"You can use this page to establish a connection between ",l.a.createElement("b",null,this.props.name),"\xa0 and your Lattice hardware wallet device.\xa0",l.a.createElement("i",null,"For more general device setup information, please see the\xa0",l.a.createElement("a",{className:"lattice-a",href:"https://gridplus.io/setup",target:"_blank",rel:"noopener noreferrer"},"Lattice setup page"),".")),l.a.createElement("h3",null,l.a.createElement("b",null,"Step 1:")),l.a.createElement("p",null,"Unlock your Lattice and find its ",l.a.createElement("b",null,"Device ID")," on the main menu. This is a six-character code."),l.a.createElement("h3",null,l.a.createElement("b",null,"Step 2:")),l.a.createElement("p",null,"Once you have your Device ID, specify a ",l.a.createElement("b",null,"password"),". This does ",l.a.createElement("i",null,"not")," secure any value and is ",l.a.createElement("i",null,"not")," associated with your wallet seed - it is only used to send secure requests to your device. If you lose your password, you can remove the permission on your device and re-connect with a new one."),l.a.createElement("h3",null,l.a.createElement("b",null,"Step 3:")),l.a.createElement("p",null,"Please ensure your Lattice is ",l.a.createElement("b",null,"online"),' and click "Connect". Your device is online if there is a single wifi signal icon on the top-right of the screen.'))}},{key:"renderModal",value:function(){return this.state.showSettings?l.a.createElement(g.a,{title:"Settings",footer:null,visible:this.state.modal,onOk:this.hideModal.bind(this),onCancel:this.hideModal.bind(this)},l.a.createElement(Me,{inModal:!0})):l.a.createElement("div",null,l.a.createElement(g.a,{title:this.props.name===_.constants.DEFAULT_APP_NAME?this.props.name:"Lattice Connector \ud83d\udd17",footer:null,visible:this.state.modal,onOk:this.hideModal.bind(this),onCancel:this.hideModal.bind(this)},this.renderSetupInfo()))}},{key:"renderMsg",value:function(){var e;if(this.state.errMsg?e=this.state.errMsg:this.props.errMsg&&(e=this.props.errMsg),e)return l.a.createElement(b.a,{message:l.a.createElement("p",null,l.a.createElement("b",null,"Error:"),l.a.createElement("br",null),e),type:"error",style:{margin:"20px 0 0 0"},closable:!0})}},{key:"render",value:function(){var e=this,t=this.context.isMobile?24:10,n=this.context.isMobile?0:7,a=null!==this.props.keyringName&&this.props.keyringName.length<5;return l.a.createElement(u.a,null,this.renderModal(),l.a.createElement(d.a,{span:t,offset:n},l.a.createElement("center",null,this.renderMsg(),l.a.createElement(y.a,{bordered:!0},l.a.createElement("a",{className:"lattice-a",href:"https://gridplus.io/lattice",target:"_blank",rel:"noopener noreferrer"},this.props.keyringName?l.a.createElement("h2",{style:{margin:"10px 0 0 0"}},"Lattice Connector ",l.a.createElement(C.a,null)):l.a.createElement("h2",{style:{margin:"10px 0 0 0"}},"Lattice Manager",l.a.createElement("br",null),l.a.createElement(T.a,null))),this.props.keyringName?l.a.createElement("div",{style:{margin:"2em"}},l.a.createElement("br",null),l.a.createElement("i",null,l.a.createElement("h3",null,"Connect to:")),l.a.createElement(A,{name:this.props.keyringName,setName:this.props.setKeyringName})):null,a?l.a.createElement("p",null,l.a.createElement("b",null,"Error: App name must be more than 4 characters.")):this.renderForm()),l.a.createElement(E.a,{type:"link",onClick:this.showModal.bind(this),style:{margin:"20px 0 0 0"}},"New User Info"),l.a.createElement("br",null),l.a.createElement(E.a,{type:"link",onClick:function(){e.setState({showSettings:!0},e.showModal)}},"Settings"),l.a.createElement("br",null),l.a.createElement(E.a,{type:"link",href:"https://gridplus.io/lattice",target:"_blank",rel:"noopener noreferrer"},"About the Lattice"))))}}]),n}(l.a.Component);B.contextType=h.a;var P=B,I=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={code:""},a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.setState({code:""}),this.input.focus()}},{key:"componentWillUnmount",value:function(){this.setState({code:""})}},{key:"handleUpdate",value:function(e){var t=this;try{this.setState({code:e.target.value.toUpperCase()},(function(){t.state.code.length>=8&&t.props.submit(t.state.code)}))}catch(n){}}},{key:"getBoxWidth",value:function(){var e=document.getElementById("secret-card");if(e)return.8*e.clientWidth}},{key:"getBoxFontHeight",value:function(){var e=this.getBoxWidth();if(e)return e/8*.6}},{key:"render",value:function(){var e=this;if(this.props.hide)return null;var t=this.context.isMobile?"small":"large",n=this.getBoxWidth(),a=this.getBoxFontHeight(),r=l.a.createElement("center",null,l.a.createElement(y.a,{title:"Enter Secret",bordered:!0,id:"secret-card"},l.a.createElement("p",null),l.a.createElement("p",null,"Please enter the pairing secret displayed on your Lattice screen:"),l.a.createElement(v.a,{className:"lattice-pairing-box",size:t,id:"secret",ref:function(t){e.input=t},onChange:this.handleUpdate.bind(this),style:{width:n,fontSize:a},value:this.state.code})));return l.a.createElement(f,{content:r})}}]),n}(l.a.Component);I.contextType=h.a;var w=I,j=n(374),R=n(644),x=n(276),N=n(670),L=n(664),D=n(210),W=n(128),U=n.n(W),M=n(359),F=n.n(M),G=n(79),K=n.n(G),H=n(139),V=n(129),Y=n.n(V),z=n(60),J=function(e){return Object(z.a)({id:e.name,category:"",header:{name:e.name,sig:e.sig,numParam:e.params.length}},e)},q=function(e){return Object(z.a)({id:e.header.name,name:e.header.name,sig:e.header.sig},e)},X=n(29),Z=n(186),$=function(){var e=Object(o.useState)(void 0),t=Object(S.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)(void 0),i=Object(S.a)(r,2),s=i[0],c=i[1],l=Object(o.useCallback)((function(e){return c((function(){return function(){e(),a(null),c(null)}}))}),[c]);return{error:n,setError:a,retryFunction:s,setRetryFunction:c,setRetryFunctionWithReset:l}},Q=_.constants.CONTRACTS_PER_PAGE,ee=_.constants.ABI_PACK_URL,te=function(){var e,t=Object(o.useContext)(h.a).session,n=Object(Z.a)(null!==(e=X.a.getContracts())&&void 0!==e?e:[]),a=Object(S.a)(n,4),r=a[0],i=a[1],s=a[2],c=a[3],l=Object(o.useState)(X.a.getContractPacks()),u=Object(S.a)(l,2),d=u[0],m=u[1],f=$(),p=f.error,E=f.setError,v=f.retryFunction,g=f.setRetryFunctionWithReset,b=Object(o.useState)(!1),y=Object(S.a)(b,2),C=y[0],T=y[1],O=Object(o.useCallback)(Object(H.a)(K.a.mark((function e(){var n,a,r=arguments;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:0,a=r.length>1&&void 0!==r[1]?r[1]:1,T(!0),e.abrupt("return",t.client.getAbiRecords({startIdx:n,n:Q,category:""}).then((function(e){var t=e.records.map(q);i(t);var a=e.numFetched+n;e.numRemaining>0?O(a):T(!1)})).catch((function(e){a>0?(E(null),O(n,a-1)):(E(e),T(!1),g(O))})));case 4:case"end":return e.stop()}}),e)}))),[i,t.client,E,g]),k=Object(o.useCallback)((function(){return fetch("".concat(ee,"/")).then((function(e){return e.json()})).catch(console.error)}),[]),A=Object(o.useCallback)((function(e){return fetch("".concat(ee,"/").concat(e.fname)).then((function(e){return e.json()})).catch(console.error)}),[]),B=Object(o.useCallback)((function(){T(!0),k().then(function(){var e=Object(H.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=m,e.next=3,Promise.all(t.map(A));case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){T(!1)}))}),[A,k]),P=Object(o.useCallback)((function(){X.a.removeContractPacks()}),[]);return Object(o.useEffect)((function(){Y()(d)&&B()}),[d,B]),Object(o.useEffect)((function(){X.a.setContracts(r)}),[r]),Object(o.useEffect)((function(){X.a.setContractPacks(d)}),[d]),{contractPacks:d,fetchContracts:O,fetchContractPacks:B,resetContractPacksInState:P,isLoading:C,setIsLoading:T,contracts:r,addContracts:function e(n){return T(!0),t.client.timeout=2*_.constants.ASYNC_SDK_TIMEOUT,t.client.addAbiDefs(n).then((function(){i(n)})).catch((function(t){E(t),g((function(){return e(n)}))})).finally((function(){T(!1),t.client.timeout=_.constants.ASYNC_SDK_TIMEOUT}))},removeContracts:function e(n){T(!0);var a=n.map((function(e){return e.header.sig}));return t.client.removeAbiRecords({sigs:a}).then((function(){s(n)})).catch((function(t){E(t),g((function(){return e(n)}))})).finally((function(){T(!1)}))},addContractsToState:i,removeContractsFromState:s,resetContractsInState:c,error:p,setError:E,retryFunction:v}},ne=n(135),ae=n(669),re=n(657),ie=n(646),se=function(e){return e&&e.length>24?"".concat(e.slice(0,10),"...").concat(e.slice(e.length-8,e.length)):null!==e&&void 0!==e?e:""};function ce(e){var t=e.pack,n=te(),a=n.addContracts,r=n.isLoading,i=Object(o.useState)(!1),s=Object(S.a)(i,2),c=s[0],u=s[1],d=Object(o.useState)(!1),h=Object(S.a)(d,2),m=h[0],f=h[1],p=_.constants.CONTRACT_NETWORKS[t.metadata.network].url,v=t.metadata,b=t.defs,T=m?l.a.createElement(E.a,{type:"default",icon:l.a.createElement(ne.a,null),disabled:m},"Added"):l.a.createElement(E.a,{type:"primary",ghost:!0,onClick:function(){a(b).then((function(){return f(!0)}))},icon:l.a.createElement(ae.a,null),loading:r},r?"Adding":"Add to Lattice");return l.a.createElement(y.a,{bordered:!0,title:v.name,style:{flex:"1 1 30%",maxWidth:"33%"},key:"card-".concat(v.name),extra:T,actions:[l.a.createElement(E.a,{type:"default",onClick:function(){u(!0)}},"View Contents"),l.a.createElement(E.a,{type:"text",href:v.website,target:"_blank",icon:l.a.createElement(C.a,null)},"Website")],bodyStyle:{height:"7em"}},l.a.createElement("p",{className:"lattice-h3"},v.desc),l.a.createElement(g.a,{title:v.name,visible:c,onOk:function(){u(!1)},onCancel:function(){u(!1)},width:1e3},l.a.createElement(re.a,{dataSource:v.addresses,rowKey:function(e){return e.address}},l.a.createElement(re.a.Column,{title:"Address",dataIndex:"address",key:"address",render:function(e){return l.a.createElement(ie.a,{color:"blue",key:"tag-".concat(e)},l.a.createElement("a",{className:"lattice-a",href:"".concat(p,"/address/").concat(e),target:"_blank",rel:"noopener noreferrer",key:"a-".concat(e)},se(e)))}}),l.a.createElement(re.a.Column,{title:"Tag",dataIndex:"tag",key:"tag"}))))}var oe=n(160),le=oe.a.Option,ue=function(e){var t=e.setNetwork;return l.a.createElement(oe.a,{style:{minWidth:"150px",marginRight:"10px"},showSearch:!0,defaultValue:_.constants.DEFAULT_CONTRACT_NETWORK,optionFilterProp:"children",onChange:t,filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0}},Object.entries(_.constants.CONTRACT_NETWORKS).map((function(e){var t=Object(S.a)(e,2),n=t[0],a=t[1];return l.a.createElement(le,{key:n,value:n},a.label)})))},de=_.constants.CONTRACT_PAGE_SIZE;function he(){var e=te(),t=e.contractPacks,n=e.isLoading,a=e.fetchContractPacks,r=e.resetContractPacksInState,i=Object(o.useState)([]),s=Object(S.a)(i,2),c=s[0],u=s[1],d=Object(o.useState)([]),h=Object(S.a)(d,2),m=h[0],f=h[1],p=Object(o.useState)(1),g=Object(S.a)(p,2),b=g[0],y=g[1],C=Object(o.useState)(_.constants.DEFAULT_CONTRACT_NETWORK),T=Object(S.a)(C,2),O=T[0],k=T[1],A=Object(o.useCallback)((function(e){return e.filter((function(e){return(null===e||void 0===e?void 0:e.metadata.network)===O}))}),[O]);Object(o.useEffect)((function(){y(1)}),[c]),Object(o.useEffect)((function(){u(A(t))}),[O,A,t]),Object(o.useEffect)((function(){var e,t=b-1,n=null!==(e=F()(c,de)[t])&&void 0!==e?e:[];f(n)}),[b,c]);return l.a.createElement("div",null,l.a.createElement("p",null,"Once loaded, please click View Contents to see the specific contracts being loaded."),l.a.createElement("p",null,"Don't see what you're looking for?"," ",l.a.createElement("a",{href:"https://github.com/GridPlus/abi-pack-framework"},"Submit a pull request.")),l.a.createElement(L.b,{direction:"vertical",style:{width:"100%"}},l.a.createElement(v.a.Group,{compact:!0,style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap",width:"100%"}},l.a.createElement(ue,{setNetwork:k}),l.a.createElement(v.a,{placeholder:"Filter",onChange:function(e){var n=e.target.value;y(1);var a=n?function(e){return U.a.go(e,t,{key:["metadata","name"]}).map((function(e){return e.obj}))}(n):t;u(A(a))},style:{maxWidth:"80%"}}),l.a.createElement(E.a,{key:"sync-button",type:"link",icon:l.a.createElement(N.a,null),disabled:n,onClick:function(){r(),a()}},"Sync")),l.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",width:"100%"}},m.length?m.map((function(e){return l.a.createElement(ce,{pack:e,key:e.metadata.name})})):l.a.createElement("div",{style:{marginTop:"20px"}},l.a.createElement("p",null,"There are not any packs for this network yet."," ",l.a.createElement("a",{href:"https://github.com/GridPlus/abi-pack-framework"},"Submit a pull request.")))),l.a.createElement("div",{style:{display:"flex",width:"100%"}},l.a.createElement(D.a,{style:{margin:"20px auto 0 auto"},current:b,defaultCurrent:1,pageSize:de,defaultPageSize:de,onChange:y,total:null===c||void 0===c?void 0:c.length}))))}var me=n(74),fe=n(208),pe=n.n(fe),Ee=_.constants.CONTRACTS_PER_PAGE,ve=function(){var e=Object(o.useState)(""),t=Object(S.a)(e,2),n=t[0],a=t[1],r=te(),i=r.isLoading,s=r.contracts,c=r.fetchContracts,u=r.removeContracts,d=r.resetContractsInState,h=Object(o.useState)([]),m=Object(S.a)(h,2),f=m[0],p=m[1],g=Object(o.useState)([]),b=Object(S.a)(g,2),y=b[0],C=b[1];Object(o.useEffect)((function(){0===s.length&&c()}),[]),Object(o.useEffect)((function(){a(""),p(s)}),[s,i]);var T=Object(o.useCallback)((function(e){return U.a.go(e,s,{keys:["header.name","header.sig"]}).map((function(e){return e.obj}))}),[s]);return l.a.createElement("div",null,l.a.createElement("div",{style:{display:"flex"}},l.a.createElement(v.a,{value:n,placeholder:"Filter",disabled:i,onChange:function(e){var t=e.target.value;a(t);var n=t?T(t):s;p(n),C(pe()(y,n,"key"))},style:{marginBottom:"1em"},allowClear:!0}),l.a.createElement(E.a,{danger:!0,type:"text",disabled:0===y.length,onClick:function(){return u(y)},style:{marginLeft:"1em"}},"Remove Selected"),l.a.createElement(E.a,{key:"sync-button",type:"link",icon:l.a.createElement(N.a,null),disabled:i,onClick:function(){d(),c()}},"Sync")),l.a.createElement(re.a,{dataSource:f,tableLayout:"fixed",rowKey:function(e){return e.id},loading:{spinning:i,tip:"Loading...",indicator:l.a.createElement(me.a,null)},pagination:{position:["bottomCenter"],pageSize:Ee,defaultCurrent:1,showSizeChanger:!1},rowSelection:{type:"checkbox",onSelect:function(e,t,n){C(n)},onSelectAll:function(e,t){C(t)},selectedRowKeys:y.map((function(e){return e.id}))},expandable:{expandedRowRender:function(e){return l.a.createElement(re.a,{columns:[{title:"Parameter Name",dataIndex:"name",key:"name"},{title:"Type",dataIndex:"typeName",key:"typeName"}],dataSource:e.params,pagination:!1,rowKey:function(e){return e.name}})},rowExpandable:function(e){return e.params.length>0}}},l.a.createElement(re.a.Column,{title:"Function Name",dataIndex:["header","name"],defaultSortOrder:"ascend",sorter:function(e,t){return e.header.name.localeCompare(t.val)}}),l.a.createElement(re.a.Column,{title:"Identifier",dataIndex:["header","sig"],defaultSortOrder:"ascend",sorter:function(e,t){return e.header.sig.localeCompare(t.val)}})))},ge=n(671),be=n(361),ye=n.n(be),Ce=_.constants.CONTRACT_NETWORKS[_.constants.DEFAULT_CONTRACT_NETWORK],Te=function(){var e=Object(o.useContext)(h.a).session,t=Object(o.useState)(!1),n=Object(S.a)(t,2),a=n[0],r=n[1],i=Object(o.useState)(!1),s=Object(S.a)(i,2),c=s[0],u=s[1],d=Object(o.useState)(""),m=Object(S.a)(d,2),f=m[0],p=m[1],g=Object(o.useState)([]),b=Object(S.a)(g,2),C=b[0],T=b[1],O=Object(o.useState)(_.constants.DEFAULT_CONTRACT_NETWORK),k=Object(S.a)(O,2),A=k[0],B=k[1],P=te(),I=P.error,w=P.setError,j=P.addContracts,x=P.isLoading,N=P.setIsLoading,L=function(){N(!1),u(!1),r(!1),p(""),T([])},D=function(){var e;return null!==(e=_.constants.CONTRACT_NETWORKS[A])&&void 0!==e?e:Ce};function W(t){if("0x"!==t.slice(0,2)||!1===/^[0-9a-fA-F]+$/.test(t.slice(2))||42!==t.length)w("Invalid ".concat(D().label," contract address")),L();else{var n=D(),a=n.label,r=n.baseUrl,i=n.apiRoute;fetch("".concat(r,"/").concat(i).concat(t)).then((function(e){return e.json()})).then((function(n){if("Contract source code not verified"===n.result&&(n.result="Contract source code not published to ".concat(a," or not verified. Cannot determine data.")),"0"===n.status)w(n.result),L();else try{var r=JSON.parse(n.result),i=e.client.parseAbi("etherscan",r,!0);T(i),p(t),w(""),u(!1),N(!1)}catch(s){w(s.toString()),L()}})).catch((function(e){w(e.toString()),L()}))}}var U=Object(o.useMemo)((function(){return ye()(W,5100)}),[A]);var M=function(){return l.a.createElement(R.a,{status:"success",title:"Success",subTitle:"Successfully sent data to your Lattice. You must confirm all functions on your Lattice for them to be saved. Please confirm or reject the definitions before continuing."})},F=function(){return l.a.createElement(R.a,{status:"error",subTitle:I})},G=function(){var e=Object.entries(_.constants.CONTRACT_NETWORKS).map((function(e){return Object(S.a)(e,2)[1]})),t=e.pop(),n=function(e){var t=e.network;return l.a.createElement("a",{className:"lattice-a",href:t.url,target:"_blank",rel:"noopener noreferrer"},t.label)};return l.a.createElement(l.a.Fragment,null,e.map((function(e){return l.a.createElement("span",{key:e.label},l.a.createElement(n,{network:e}),", ")})),"or ",l.a.createElement(n,{network:t}))};return l.a.createElement("div",null,l.a.createElement("p",null,"You can install contract data from any supported contract which has been verified by\xa0",l.a.createElement(G,null),"."),l.a.createElement("p",null,"Search for a verified smart contract:"),l.a.createElement(v.a.Group,null,l.a.createElement(ue,{setNetwork:B}),l.a.createElement(v.a.Search,{style:{maxWidth:"80%"},placeholder:"Contract address",allowClear:!0,enterButton:!0,loading:x,onSearch:function(e){N(!0),U(e)}})),f&&!c&&!I&&l.a.createElement(y.a,{title:f,style:{marginTop:"20px"},actions:[l.a.createElement(E.a,{type:"primary",onClick:function(){r(!0),w("");var e=C.map(J);j(e).then((function(){w(""),r(!1),u(!0)})).catch((function(e){w(e),L()}))},loading:a,icon:l.a.createElement(ge.a,null)},a?"Installing...":"Install")]},l.a.createElement("p",null,"Found ",l.a.createElement("b",null,C.length)," functions to add from this contract.")),c&&l.a.createElement(M,null),I&&l.a.createElement(F,null))},_e=(n(142),function(e){var t=e.error,n=e.retryFunction;return t?l.a.createElement(b.a,{message:"Error",description:t,type:"error",closable:!0,action:l.a.createElement(E.a,{type:"danger",onClick:function(){n&&n()}},"Retry")}):null}),Se="1",Oe="2",ke="3",Ae="4",Be=function(){var e=Object(o.useContext)(h.a).session,t=te(),n=t.error,a=t.setError,r=t.retryFunction,i=t.addContracts,s=t.isLoading,c=Object(o.useState)([]),u=Object(S.a)(c,2),d=u[0],m=u[1],p=Object(o.useState)([]),g=Object(S.a)(p,2),b=g[0],C=g[1],T=Object(o.useState)(""),O=Object(S.a)(T,2),k=O[0],A=O[1],B=Object(o.useState)(!1),P=Object(S.a)(B,2),I=P[0],w=P[1],N=Object(o.useState)(Se),L=Object(S.a)(N,2),D=L[0],W=L[1],U=function(){var e=Object(o.useContext)(h.a).session.client.getFwVersion(),t=e.fix,n=e.minor,a=e.major;return Object.fromEntries(Object.entries({CAN_VIEW_CONTRACTS:[0,14,0]}).map((function(e){var r=Object(S.a)(e,2),i=r[0],s=Object(S.a)(r[1],3),c=s[0],o=s[1],l=s[2];return[i,t>=c&&n>=o&&a>=l]})))}().CAN_VIEW_CONTRACTS;function M(e){W(e),w(!1),a(null)}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return l.a.createElement(R.a,{status:"success",title:"Success",subTitle:"Successfully sent data to your Lattice. You must confirm all functions on your Lattice for them to be saved. Please confirm or reject the definitions before continuing.",extra:null!==e?[l.a.createElement(E.a,{type:"primary",key:"buttonTxt",onClick:function(){w(!1)}},e)]:null})}function G(){return l.a.createElement("div",null,l.a.createElement("p",null,'Here you can add ABI definitions manually. Please stick with Etherscan formatting (i.e. the contents of "Contract ABI" in the Contract tab -\xa0',l.a.createElement("a",{className:"lattice-a",href:"https://etherscan.io/address/0x1494ca1f11d487c2bbe4543e90080aeba4ba3c2b#code",target:"_blank",rel:"noopener noreferrer"},"example"),")."),l.a.createElement(v.a.TextArea,{placeholder:"".concat('[{"inputs":[{"internalType":"address[]","name":"_components","type":"address[]"},{"internalType":"int256[]","name":"_units","type":"int256[]"},{"internalType":"address[]","name":"_modules","type":"address[]"},{"internalType":"contract IController","name":"_controller","type":"address"},{"internalType":"address","name":"_manager","type":"address"},{"internalType":"string","name":"_name","type":"string"},',"..."),autoSize:{minRows:5,maxRows:10},value:k,onChange:function(t){var n=t.target.value;try{var a=JSON.parse(n),r=function(e){var t=[];return e.forEach((function(e){var n=!0;0===e.name.length?n=!1:e.params.forEach((function(e){0===e.name.length&&(n=!1)})),!0===n&&t.push(e)})),t}(e.client.parseAbi("etherscan",a,!0));r.length>0&&(C(r),w(!1),A(n))}catch(i){console.warn("Failed to scan for ABI definitions ".concat(i.message)),C([]),w(!1),A(n)}}}),l.a.createElement("br",null),l.a.createElement("br",null),b&&b.length>0?l.a.createElement("div",null,I?l.a.createElement("div",null,l.a.createElement("center",null,F(),l.a.createElement(E.a,{type:"primary",onClick:function(){C([]),A(""),w(!1)}},"Add More"))):l.a.createElement("div",null,l.a.createElement("p",null,"Found ",l.a.createElement("b",null,b.length)," functions that can be added.",l.a.createElement("br",null),l.a.createElement("i",null,"Note: functions with unsupported types are not included.")),l.a.createElement(E.a,{type:"primary",onClick:function(){i(b||d).then((function(){w(!0)})).catch((function(){w(!1)}))},loading:s},s?"Installing...":"Install"),I?l.a.createElement("div",null,l.a.createElement("br",null),F()):null)):null)}function K(){return l.a.createElement("div",null,function(){return l.a.createElement(x.a,{activeKey:D,onChange:M.bind(this)},l.a.createElement(x.a.TabPane,{tab:"Add Packs",key:Se}),l.a.createElement(x.a.TabPane,{tab:"Add By Address",key:Oe}),l.a.createElement(x.a.TabPane,{tab:"Add Manually",key:ke}),U&&l.a.createElement(x.a.TabPane,{tab:"View Added",key:Ae}))}(),function(){switch(D){case ke:return G();case Oe:return l.a.createElement(Te,null);case Ae:return l.a.createElement(ve,null);case Se:default:return l.a.createElement(he,null)}}())}return function(){var e=l.a.createElement("div",null,l.a.createElement(_e,{error:n,retryFunction:function(){r(),m([]),w(!1),C([]),A("")}}),l.a.createElement(y.a,{title:l.a.createElement("div",null,l.a.createElement("h3",null,"Contract Data\xa0\xa0",l.a.createElement("a",{className:"lattice-a",href:_.constants.CONTRACTS_HELP_LINK,target:"_blank",rel:"noopener noreferrer"},l.a.createElement(j.a,null)))),bordered:!0},K()));return l.a.createElement(f,{content:e})}()},Pe=n(207),Ie=n(48),we=n(206),je=n(104),Re={ETH:{name:"ETH",decimals:18},BTC:{name:"BTC",decimals:8}},xe=(l.a.Component,n(211)),Ne=n(140),Le=n(662),De=n(672),We=n(138),Ue=n.n(We),Me=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={settings:X.a.getSettings(),keyring:X.a.getKeyring()},a.getBtcPurposeName=a.getBtcPurposeName.bind(Object(p.a)(a)),a}return Object(i.a)(n,[{key:"submit",value:function(){X.a.setSettings(this.state.settings),window.location.reload()}},{key:"updateUseCustomEndpoint",value:function(e){var t=this.state.settings;!0!==e&&(t.customEndpoint=""),this.setState({settings:t})}},{key:"updateCustomEndpoint",value:function(e){var t=this.state.settings;t.customEndpoint=e.target.value,this.setState({settings:t})}},{key:"updateUseDevLattice",value:function(e){var t=this.state.settings;t.devLattice=e.target.checked,this.setState({settings:t},this.submit)}},{key:"removeKeyring",value:function(e){var t=e.name;X.a.removeKeyringItem(t),this.setState({keyring:Ue()(this.state.keyring,t)})}},{key:"resetState",value:function(){X.a.removeRootStore(),window.location.reload()}},{key:"renderCustomEndpointSetting",value:function(){var e=this.state.settings.customEndpoint,t=void 0===e?"":e;return l.a.createElement(y.a,null,l.a.createElement(u.a,{justify:"center"},l.a.createElement(d.a,{span:20},l.a.createElement("h3",null,"Connection Endpoint:"),l.a.createElement("p",null,"If you wish to route messages and connections through your own endpoint, you may specify it here.\xa0 Otherwise leave blank.\xa0 See\xa0",l.a.createElement("a",{href:"https://github.com/GridPlus/lattice-connect",className:"lattice-a",target:"_blank",rel:"noopener noreferrer"},"this")," for more information."),l.a.createElement("div",null,l.a.createElement(v.a,{placeholder:"host:port",defaultValue:t,onChange:this.updateCustomEndpoint.bind(this)})))))}},{key:"handleChangeBitcoinVersionSetting",value:function(e){var t=this.state.settings;t.btcPurpose=parseInt(e.target.value),this.setState({settings:t},this.submit)}},{key:"getBtcPurposeName",value:function(){var e=this.state.settings.btcPurpose?this.state.settings.btcPurpose:Object(_.getBtcPurpose)();return e===_.constants.BTC_PURPOSE_NONE?_.constants.BTC_PURPOSE_NONE_STR:e===_.constants.BTC_PURPOSE_LEGACY?_.constants.BTC_PURPOSE_LEGACY_STR:e===_.constants.BTC_PURPOSE_WRAPPED_SEGWIT?_.constants.BTC_PURPOSE_WRAPPED_SEGWIT_STR:e===_.constants.BTC_PURPOSE_SEGWIT?_.constants.BTC_PURPOSE_SEGWIT_STR:"Error finding BTC version"}},{key:"renderBitcoinVersionSetting",value:function(){var e=Object(_.getBtcPurpose)()||_.constants.BTC_PURPOSE_NONE;return l.a.createElement(y.a,null,l.a.createElement("h4",null,"Bitcoin Wallet Type"),l.a.createElement(xe.a.Group,{onChange:this.handleChangeBitcoinVersionSetting.bind(this),defaultValue:e},l.a.createElement(L.b,{direction:"vertical"},l.a.createElement(xe.a,{value:_.constants.BTC_PURPOSE_NONE},"Hide BTC Wallet"),l.a.createElement(xe.a,{value:_.constants.BTC_PURPOSE_SEGWIT},_.constants.BTC_PURPOSE_SEGWIT_STR),l.a.createElement(xe.a,{value:_.constants.BTC_PURPOSE_WRAPPED_SEGWIT},_.constants.BTC_PURPOSE_WRAPPED_SEGWIT_STR),l.a.createElement(xe.a,{value:_.constants.BTC_PURPOSE_LEGACY},_.constants.BTC_PURPOSE_LEGACY_STR))))}},{key:"renderDevLatticeSetting",value:function(){var e=this.state.settings.devLattice;return l.a.createElement(y.a,null,l.a.createElement("h4",null,"Debug Settings"),l.a.createElement(u.a,{justify:"center",style:{margin:"10px 0 0 0"}},l.a.createElement(E.a,{type:"link",onClick:this.resetState,className:"warning-a"},l.a.createElement(De.a,null),"\xa0Reset App State")),l.a.createElement(u.a,{justify:"center",style:{margin:"20px 0 0 0"}},l.a.createElement(Ne.a,{onChange:this.updateUseDevLattice.bind(this),checked:e},"Using Dev Lattice")))}},{key:"renderKeyringsSetting",value:function(){var e=this,t=X.a.getKeyring(),n=[{title:"App Name",dataIndex:"name",key:"name"},{title:"Action",dataIndex:"action",key:"action",render:function(t,n){return l.a.createElement(E.a,{type:"link",onClick:function(){e.removeKeyring(n)}},"Forget")}}],a=[];return Object.keys(t).sort((function(e,t){return e.toLowerCase()>t.toLowerCase()?1:-1})).forEach((function(e){a.push({name:e,key:e})})),l.a.createElement(y.a,null,l.a.createElement(u.a,{justify:"center"},l.a.createElement(d.a,{span:20},l.a.createElement("h3",null,"Third Party Connections"),l.a.createElement("p",null,"Manage connections to your Lattice. Third party apps should be listed here if they are connected to your device."),l.a.createElement(Le.a,null,l.a.createElement(Le.a.Panel,{header:"Connections List (".concat(a.length,")")},l.a.createElement(re.a,{dataSource:a,columns:n}))))))}},{key:"renderCard",value:function(){return l.a.createElement("div",null,this.renderKeyringsSetting(),this.renderCustomEndpointSetting(),this.renderBitcoinVersionSetting(),this.renderDevLatticeSetting(),l.a.createElement("br",null),l.a.createElement(E.a,{type:"primary",onClick:this.submit.bind(this)},"Update and Reload"))}},{key:"render",value:function(){var e=l.a.createElement("center",null,l.a.createElement(y.a,{title:"Settings",bordered:!0},this.renderCard()));return this.props.inModal?l.a.createElement("center",null,this.renderCard()):l.a.createElement(f,{content:e})}}]),n}(l.a.Component),Fe=_.constants.ADDRESSES_PER_PAGE,Ge=function(){var e=Object(o.useContext)(h.a),t=e.session,n=e.isLoadingAddresses,a=e.setIsLoadingAddresses,r=e.addresses,i=e.addAddressesToState,s=e.removeAddressesFromState,c=e.resetAddressesInState,l=$(),u=l.error,d=l.setError,m=l.retryFunction,f=l.setRetryFunctionWithReset,p=Object(o.useCallback)(Object(H.a)(K.a.mark((function e(){var n,r,s=arguments;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>0&&void 0!==s[0]?s[0]:0,r=s.length>1&&void 0!==s[1]?s[1]:1,a(!0),e.abrupt("return",t.client.getKvRecords({start:n,n:Fe}).then((function(e){i(e.records);var t=e.fetched+n;e.total-t>0?p(n+e.fetched):(d(null),a(!1))})).catch((function(e){r>0?(d(null),p(n,r-1)):(d(e),a(!1),f(p))})));case 4:case"end":return e.stop()}}),e)}))),[i,t.client,d,a,f]),E=function(){var e=Object(H.a)(K.a.mark((function e(n){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.abrupt("return",t.client.addKvRecords({caseSensitive:!1,type:0,records:n}).then((function(){p()})).catch((function(e){throw d(e),f((function(){return E(n)})),e})).finally((function(){a(!1)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{fetchAddresses:p,addresses:r,addAddresses:E,addAddressesToState:i,removeAddresses:function e(n){var r=n.map((function(e){return parseInt(e.id)}));if(!Y()(r))return a(!0),t.client.removeKvRecords({ids:r}).then((function(){s(n),d(null)})).catch((function(t){d(t),f((function(){return e(n)}))})).finally((function(){a(!1)}))},removeAddressesFromState:s,resetAddressesInState:c,isLoadingAddresses:n,error:u,setError:d,retryFunction:m}},Ke=n(373),He=n(375),Ve=n(673),Ye=n(362),ze=n.n(Ye),Je=["key","name"],qe=function(){var e=Ge(),t=e.addresses,n=e.addAddresses,a=e.isLoadingAddresses,r=e.error,i=e.setError,s=e.retryFunction,c=k.a.useForm(),u=Object(S.a)(c,1)[0],d=Object(o.useState)(!1),h=Object(S.a)(d,2),m=h[0],f=h[1],p=function(){f(!1)},b=function(){p()};return l.a.createElement(l.a.Fragment,null,l.a.createElement(E.a,{type:"ghost",onClick:function(){f(!0)},icon:l.a.createElement(He.a,null)},"Add"),l.a.createElement(g.a,{title:"Add Address Tags",visible:m,maskClosable:!1,onOk:u.submit,onCancel:b,destroyOnClose:!0,footer:[l.a.createElement(E.a,{type:"link",onClick:b,key:"cancel"},"Cancel"),l.a.createElement(E.a,{type:"primary",loading:a,onClick:u.submit,key:"add"},"Add")]},l.a.createElement(L.b,{direction:"vertical",style:{width:"100%"}},l.a.createElement(_e,{error:r,retryFunction:s}),l.a.createElement(k.a,{form:u,name:"formData",onFinish:function(){u.validateFields().then((function(e){var t=e.recordsToAdd,a=ze.a.chain(t).keyBy("key").mapValues("val").value();n(a).then(p).catch(console.error)}))},onFinishFailed:function(){i("Unable to submit. Fix errors in form and try again.")},onFieldsChange:function(){i(null)},autoComplete:"off",preserve:!1,layout:"vertical"},l.a.createElement(k.a.List,{name:"recordsToAdd",initialValue:[{key:null,val:null}]},(function(e,n){var r=n.add,i=n.remove;return l.a.createElement(l.a.Fragment,null,e.map((function(e){e.key;var n=e.name,r=Object(Ke.a)(e,Je);return l.a.createElement("div",{key:"".concat(n,"-inputs"),style:{display:"flex",flexDirection:"row",marginBottom:"1em",width:"100%"}},l.a.createElement("div",{style:{display:"flex",flexDirection:"column",flexGrow:1}},l.a.createElement(k.a.Item,Object.assign({},r,{name:[n,"key"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Address is required."},{max:63,type:"string",message:"Must be shorter than ".concat(63," characters.")},{validator:function(e,n){return(null===t||void 0===t?void 0:t.some((function(e){return e.key===n})))?Promise.reject(new Error("You already have a tag with this address on your device.")):Promise.resolve()},validateTrigger:["onChange","onBlur"]}]}),l.a.createElement(v.a,{addonBefore:"Address","data-testid":"".concat(n,"-address-input")})),l.a.createElement(k.a.Item,Object.assign({},r,{name:[n,"val"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"Name is required"},{max:63,type:"string",message:"Must be shorter than ".concat(63," characters.")},{validator:function(e,n){return(null===t||void 0===t?void 0:t.some((function(e){return e.val===n})))?Promise.reject(new Error("You already have a tag with this name on your device.")):Promise.resolve()},validateTrigger:["onChange","onBlur"]}]}),l.a.createElement(v.a,{addonBefore:"Name","data-testid":"".concat(n,"-name-input")}))),n>0?l.a.createElement(E.a,{type:"text",icon:l.a.createElement(Ve.a,null),disabled:a,style:{height:"auto",marginLeft:"1em",marginBottom:"1.2em"},onClick:function(){return i(n)}}):null)})),l.a.createElement(k.a.Item,null,l.a.createElement(E.a,{type:"dashed",block:!0,icon:l.a.createElement(He.a,null),disabled:a,onClick:r},"Add Another Address Tag")))}))))))},Xe=_.constants.ADDRESSES_PER_PAGE,Ze=function(){var e=Ge(),t=e.isLoadingAddresses,n=e.addresses,a=e.removeAddresses,r=Object(o.useState)(""),i=Object(S.a)(r,2),s=i[0],c=i[1],u=Object(o.useState)([]),d=Object(S.a)(u,2),h=d[0],m=d[1],f=Object(o.useState)([]),p=Object(S.a)(f,2),g=p[0],b=p[1];Object(o.useEffect)((function(){c(""),m(n)}),[n,t]);var y=Object(o.useCallback)((function(e){return U.a.go(e,n,{keys:["key","val"]}).map((function(e){return e.obj}))}),[n]);return l.a.createElement("div",null,l.a.createElement("div",{style:{display:"flex"}},l.a.createElement(v.a,{value:s,placeholder:"Filter",disabled:t,onChange:function(e){var t=e.target.value;c(t);var a=t?y(t):n;m(a),b(pe()(g,a,"key"))},style:{marginBottom:"1em"},allowClear:!0}),l.a.createElement(E.a,{danger:!0,type:"text",disabled:0===g.length,onClick:function(){return a(g).then((function(){b([])}))},style:{marginLeft:"1em"}},"Remove Selected")),l.a.createElement(re.a,{dataSource:h,tableLayout:"fixed",loading:{spinning:t,tip:"Loading...",indicator:l.a.createElement(me.a,null)},pagination:{position:["bottomCenter"],pageSize:Xe,defaultCurrent:1,showSizeChanger:!1},rowSelection:{type:"checkbox",onSelect:function(e,t,n){b(n)},onSelectAll:function(e,t){b(t)},selectedRowKeys:g.map((function(e){return e.key}))}},l.a.createElement(re.a.Column,{title:"Name",dataIndex:"val",key:"val",defaultSortOrder:"ascend",sorter:function(e,t){return e.val.localeCompare(t.val)}}),l.a.createElement(re.a.Column,{title:"Address",dataIndex:"key",key:"key",render:function(e){return se(e)},sorter:function(e,t){return e.key.localeCompare(t.key)}})))},$e=function(){var e=Ge(),t=e.fetchAddresses,n=e.isLoadingAddresses,a=e.addresses,r=e.resetAddressesInState,i=e.error,s=e.retryFunction;Object(o.useEffect)((function(){Y()(a)&&!n&&t()}),[]);var c=[l.a.createElement(E.a,{key:"sync-button",type:"link",icon:l.a.createElement(N.a,null),disabled:n,onClick:function(){r(),t()}},"Sync"),l.a.createElement(qe,{key:"add-addresses-button"})];return l.a.createElement(f,null,l.a.createElement(_e,{error:i,retryFunction:s}),l.a.createElement(y.a,{title:"Saved Addresses",extra:c,bordered:!0},l.a.createElement(Ze,null)))},Qe=n(648),et=n(649),tt=n(656),nt=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"renderCard",value:function(){return l.a.createElement(y.a,{bordered:!0,style:{textAlign:"center"}},l.a.createElement(u.a,{justify:"center"},l.a.createElement(d.a,{span:20},l.a.createElement("p",{className:"lattice-h1"},l.a.createElement(T.a,null),"\xa0Lattice Manager"),l.a.createElement("p",{className:"lattice-h4"},"Manage secure data on your Lattice hardware wallet device for a better web3 experience:"),l.a.createElement("br",null))),l.a.createElement(u.a,{justify:"center"},l.a.createElement(d.a,{span:20},l.a.createElement("p",null,l.a.createElement("a",{href:_.constants.TAGS_HELP_LINK,className:"lattice-a",target:"_blank",rel:"noopener noreferrer"},l.a.createElement(Qe.a,null),"\xa0",l.a.createElement("b",null,"Address Tags"),"\xa0"),l.a.createElement("br",null),l.a.createElement("i",null,"Give names to your favorite contracts or recipient addresses.")),l.a.createElement("br",null))),l.a.createElement(u.a,{justify:"center"},l.a.createElement(d.a,{span:20},l.a.createElement("p",null,l.a.createElement("a",{href:_.constants.CONTRACTS_HELP_LINK,className:"lattice-a",target:"_blank",rel:"noopener noreferrer"},l.a.createElement(et.a,null),"\xa0",l.a.createElement("b",null,"Contracts"),"\xa0"),l.a.createElement("br",null),l.a.createElement("i",null,"Add your favorite smart contracts for better transaction request readability.")))),l.a.createElement(tt.a,null),l.a.createElement("img",{src:"lattice-landing.jpg",style:{maxHeight:"500px",maxWidth:"100%"},alt:"lattice-one-device"}))}},{key:"render",value:function(){return l.a.createElement(f,{content:this.renderCard()})}}]),n}(l.a.Component),at=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=l.a.createElement("center",null,l.a.createElement(y.a,{title:"Loading",bordered:!0},!1!==this.props.spin?l.a.createElement(Pe.a,{indicator:l.a.createElement(me.a,null)}):null,l.a.createElement("p",null,this.props.msg?this.props.msg:"Waiting for data from your Lattice"),this.props.onCancel?l.a.createElement(E.a,{type:"link",onClick:this.props.onCancel},"Cancel"):null));return l.a.createElement(f,{content:e})}}]),n}(l.a.Component),rt=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).keyPressListener=a.keyPressListener.bind(Object(p.a)(a)),a.submit=a.submit.bind(Object(p.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keypress",this.keyPressListener)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keypress",this.keyPressListener)}},{key:"keyPressListener",value:function(e){"Enter"===e.key&&this.submit()}},{key:"submit",value:function(){this.props.retryCb()}},{key:"render",value:function(){return l.a.createElement("center",null,l.a.createElement(y.a,{title:"Error",bordered:!0},l.a.createElement("p",null,this.props.msg),this.props.retryCb?l.a.createElement(E.a,{id:"submitButton",onClick:this.submit,type:"danger"},this.props.btnMsg||"Retry"):null))}}]),n}(l.a.Component),it=n(350),st=n(665),ct=n(367),ot=n(659),lt=n(653),ut=n(652),dt=n(674),ht=n(675),mt=n(676),ft=n(279),pt=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.session&&this.props.session.getBtcWalletData()}},{key:"getInnerWidth",value:function(){var e;return null===(e=document.getElementById("main-content-inner"))||void 0===e?void 0:e.offsetWidth}},{key:"ensureTrimmedText",value:function(e){if(!this.context.isMobile)return e;var t=this.getInnerWidth()/22;return e.length>t?"".concat(e.slice(0,t),"..."):e}},{key:"renderListItem",value:function(e){var t=l.a.createElement("div",{align:this.context.isMobile?"left":"right"},e.confirmed?l.a.createElement("p",null,e.incoming?"Received ":"Sent ",function(e){var t=new Date(e),n=new Date,a=864e5,r=n-t;return r/6e4<1?"seconds":r/36e5<1?"".concat(Math.floor(r/6e4)," minutes"):r/a<1?"".concat(Math.floor(r/36e5)," hours"):r/6048e5<1?"".concat(Math.floor(r/a)," days"):r/24192e5<1?"".concat(Math.floor(r/6048e5)," weeks"):r/290304e5<1?"".concat(Math.floor(r/24192e5)," months"):"".concat(Math.floor(r/290304e5)," years")}(e.timestamp)," ago"):null,l.a.createElement(E.a,{size:"small",href:"".concat(_.constants.BTC_TX_BASE_URL,"/").concat(e.id),target:"_blank"},"View"));if(0===e.value)return l.a.createElement(st.b.Item,{key:e.hash},l.a.createElement(st.b.Item.Meta,{avatar:l.a.createElement(ct.a,{src:"/BTC.png"}),title:"Internal Transaction",description:"This transaction sender and recipient are your addresses."}),t);var n="".concat(e.value/Math.pow(10,8)," BTC"),a="\t".concat(this.ensureTrimmedText(e.recipient)),r=l.a.createElement(st.b.Item.Meta,{avatar:l.a.createElement(ct.a,{src:"/BTC.png"}),title:e.confirmed?l.a.createElement("p",null,"".concat(n)):l.a.createElement("p",null,l.a.createElement("i",null,"".concat(n))),description:e.confirmed?l.a.createElement("p",null,e.incoming?l.a.createElement(lt.a,null):l.a.createElement(ut.a,null),"".concat(a)):l.a.createElement("p",null,e.incoming?l.a.createElement(lt.a,null):l.a.createElement(ut.a,null),l.a.createElement("i",null,"".concat(a)))});return this.context.isMobile?l.a.createElement(st.b.Item,{key:e.hash},l.a.createElement(u.a,{justify:"center"},r),l.a.createElement(u.a,{justify:"center"},t)):l.a.createElement(st.b.Item,{key:e.hash},r,t)}},{key:"renderLastUpdatedTag",value:function(){if(this.props.session){var e=this.props.session.lastFetchedBtcData;if(!e)return l.a.createElement(ie.a,{color:"red"},"Never");var t,n,a,r=Math.floor((new Date-e)/1e3);return r<60?(t="",n="seconds",a="green"):r<3600?(n=1===(t=Math.floor(r/60))?"min":"mins",a="green"):r<172800?(n=1===(t=Math.floor(r/3600))?"hour":"hours",a="orange"):(t=Math.floor(r/86400),n="days",a="red"),l.a.createElement(ie.a,{color:a},"".concat(t," ").concat(n," ago"))}}},{key:"renderList",value:function(){var e=this,t={confirmed:this.props.session.getBtcTxs(),pending:this.props.session.getBtcTxs(!1)};return l.a.createElement("div",null,t.pending.length>0?l.a.createElement(y.a,{title:l.a.createElement("p",null,l.a.createElement(dt.a,null)," Pending"),bordered:!0,style:{margin:"0 0 30px 0"}},l.a.createElement(st.b,{itemLayout:"horizontal",dataSource:t.pending,renderItem:function(t){return e.renderListItem(t)}})):null,l.a.createElement(y.a,{title:"Transactions",bordered:!0},l.a.createElement(st.b,{itemLayout:"horizontal",dataSource:t.confirmed,renderItem:function(t){return e.renderListItem(t)}})))}},{key:"renderHeader",value:function(){var e=this.props.session.getBtcBalance()/_.constants.SATS_TO_BTC,t=this.props.session.btcPrice;return l.a.createElement("div",null,l.a.createElement(u.a,{justify:"center",style:{margin:"20px 0 0 0"}},l.a.createElement(ot.a,{title:"Balance",value:"".concat(e," BTC")})),l.a.createElement(u.a,{justify:"center"},l.a.createElement(ot.a,{title:"USD Value",value:e*t,precision:2})))}},{key:"renderPages",value:function(){var e=this,t=this.props.session.getPage(),n=this.props.session.getBtcTxs();return l.a.createElement("center",{style:{margin:"20px 0 0 0"}},t>1?l.a.createElement(E.a,{onClick:function(){e.props.pageTurnCb(t-1)}},l.a.createElement(ht.a,null)):null,n.length>=_.constants.PAGE_SIZE?l.a.createElement(E.a,{onClick:function(){e.props.pageTurnCb(t+1)}},l.a.createElement(mt.a,null)):null)}},{key:"renderStartCard",value:function(){var e=this;return l.a.createElement(y.a,{title:"BTC Wallet",bordered:!0},l.a.createElement("center",null,l.a.createElement("p",null,"You have not loaded any addresses yet."),l.a.createElement(E.a,{size:"large",type:"primary",ghost:!0,onClick:function(){e.props.refreshData()}},"Start")))}},{key:"renderContent",value:function(){var e=this;return this.props.session.lastFetchedBtcData?l.a.createElement("div",null,l.a.createElement(y.a,{title:"BTC Wallet",bordered:!0},l.a.createElement(u.a,{justify:"center"},"Last Update\xa0",this.renderLastUpdatedTag(),l.a.createElement(E.a,{size:"small",type:"primary",ghost:!0,onClick:function(){e.props.refreshData()}},"Refresh ",l.a.createElement(ft.a,null))),l.a.createElement(u.a,{justify:"center",style:{margin:"20px 0 0 0"}},this.renderHeader())),l.a.createElement(tt.a,null),l.a.createElement("div",null,this.renderList(),this.renderPages())):this.renderStartCard()}},{key:"render",value:function(){var e=l.a.createElement("center",null,this.renderContent());return l.a.createElement(f,{content:e})}}]),n}(l.a.Component);pt.contextType=h.a;var Et=pt;var vt=n(372),gt=n(660),bt=n(90),yt=n(137),Ct=n(20).Buffer,Tt=n(8).validateBtcAddr,_t={ETH:{full:function(e){return St(e,Ot)},recipient:Ot,value:kt},BTC:{full:function(e){return St(e,Tt)},recipient:Tt,value:kt}};function St(e,t){return!0===t(e.recipient)&&!0===kt(e.value)}function Ot(e){if(""===e)return null;try{var t="0x"===e.slice(0,2),n=20===Ct.from(e.slice(2),"hex").length;return!0===t&&!0===n}catch(a){return!1}}function kt(e){if(""===e)return!1;try{var t=Number(e);return!isNaN(t)&&t>=0}catch(n){return!1}}var At=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={recipient:"",value:null,recipientCheck:null,valueCheck:null,error:null,isLoading:!1,txHash:null,btcFeeRate:_.constants.BTC_DEFAULT_FEE_RATE,ensResolvedAddress:null},a.handleENSResolution=a.handleENSResolution.bind(Object(p.a)(a)),a.renderBanner=a.renderBanner.bind(Object(p.a)(a)),a.renderSubmitButton=a.renderSubmitButton.bind(Object(p.a)(a)),a.renderValueLabel=a.renderValueLabel.bind(Object(p.a)(a)),a.submit=a.submit.bind(Object(p.a)(a)),a.buildBtcRequest=a.buildBtcRequest.bind(Object(p.a)(a)),a.updateBtcFeeRate=a.updateBtcFeeRate.bind(Object(p.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch("https://blockstream.info/api/fee-estimates").then((function(e){return e.json()})).then((function(t){t[1]&&e.setState({btcFeeRate:Math.ceil(Number(t[1]))}),e.props.session&&e.props.session.getBtcWalletData()})).catch((function(e){console.error("Error from fetching fee rates: ".concat(e.toString()))}))}},{key:"handleENSResolution",value:function(e,t){return e||null===t?this.setState({recipientCheck:!1,ensResolvedAddress:null}):this.setState({recipientCheck:!0,ensResolvedAddress:t})}},{key:"updateRecipient",value:function(e){var t=e.target.value,n=_t.BTC.recipient(t);this.setState({recipient:t,ensResolvedAddress:null,recipientCheck:n})}},{key:"checkValue",value:function(e){var t=this.props.session.getBtcBalance()/_.constants.SATS_TO_BTC;return""===e||null===e||void 0===e?null:Number(t)>=Number(e)}},{key:"updateValue",value:function(e){var t=e.target.value,n=Number(t),a="0"===t[0],r=a&&"."===t[1];if("0"===t);else if(isNaN(n)){if("."!==t)return;t="0"+t}else a&&!r&&(t=t.slice(1));this.setState({value:t,valueCheck:this.checkValue(t)})}},{key:"updateBtcFeeRate",value:function(e){this.setState({btcFeeRate:e})}},{key:"buildBtcRequest",value:function(){var e=Object(_.buildBtcTxReq)(this.state.recipient,this.state.value,this.props.session.btcUtxos,this.props.session.addresses.BTC,this.props.session.addresses.BTC_CHANGE,this.state.btcFeeRate,this.state.value===this.calculateMaxValue());return e.error?(this.setState({error:e.error}),null):e.data?e:(this.setState({error:"Invalid response when building BTC transaction request. "}),null)}},{key:"submit",value:function(){var e=this,t=this.buildBtcRequest();t&&(vt.a.open({message:"Waiting for signature...",key:"signNotification",description:"We have sent the transaction to your Lattice for signing.\n                      After approval, the transaction will be broadcast.",duration:0}),this.setState({isLoading:!0}),this.props.session.sign(t,(function(t,n){vt.a.close("signNotification"),t?e.setState({error:t,isLoading:!1,txHash:null}):e.setState({recipient:"",recipientCheck:null,value:null,valueCheck:null,txHash:n,error:null,isLoading:!1})})))}},{key:"getUrl",value:function(){return"".concat(_.constants.BTC_TX_BASE_URL,"/").concat(this.state.txHash)}},{key:"renderValueLabelTitle",value:function(){var e=this;return l.a.createElement("p",{style:{textAlign:"left"}},l.a.createElement("b",null,"Value"),l.a.createElement(E.a,{type:"link",onClick:function(){e.updateValue({target:{value:e.calculateMaxValue()}})}},"Max"),this.renderIcon("value"))}},{key:"renderValueLabel",value:function(){var e=l.a.createElement(v.a,{type:"text",id:"value",value:this.state.value,onChange:this.updateValue.bind(this)});return l.a.createElement(u.a,{justify:"center"},this.renderValueLabelTitle(),e)}},{key:"renderRecipientLabel",value:function(){return l.a.createElement(u.a,{justify:"center"},l.a.createElement("p",{style:{textAlign:"left"}},l.a.createElement("b",null,"Recipient"),"\xa0\xa0\xa0",this.renderIcon("recipient")),l.a.createElement(v.a,{type:"text",id:"recipient",value:this.state.recipient,onChange:this.updateRecipient.bind(this)}))}},{key:"renderIcon",value:function(e){var t="".concat(e,"Check"),n=this.state[t];return!0===n?l.a.createElement(ne.a,{style:{color:"green"}}):!1===n?l.a.createElement(yt.a,{style:{color:"red"}}):void 0}},{key:"renderBanner",value:function(){var e=this;if(this.state.error)return l.a.createElement(b.a,{message:"Failed to Send Transaction",description:this.state.error,type:"error",closable:!0,onClose:function(){e.setState({error:null})}});if(this.state.txHash){var t=this.context.isMobile?l.a.createElement("p",null,"Transaction signed and broadcast successfully.\xa0",l.a.createElement("a",{className:"lattice-a",target:"_blank",rel:"noopener noreferrer",href:this.getUrl()},"View")):l.a.createElement("p",null,"Your transaction was signed and broadcast successfully. Please return to your History tab and refresh to see status.");return l.a.createElement(b.a,{type:"success",message:"Success",description:t})}}},{key:"renderExtra",value:function(){return l.a.createElement("div",null,l.a.createElement(u.a,{justify:"center"},l.a.createElement("b",null,l.a.createElement("p",null,"Fee (sat/byte):"))),l.a.createElement(u.a,{justify:"center"},l.a.createElement(gt.a,{min:1,max:100,onChange:this.updateBtcFeeRate,value:this.state.btcFeeRate})))}},{key:"calculateMaxValue",value:function(){var e=this.props.session.getBtcBalance(),t=this.props.session.getBtcUtxos(),n=Object(_.getBtcNumTxBytes)(t.length),a=Math.floor(this.state.btcFeeRate*n);return Math.max(((e-a)/_.constants.SATS_TO_BTC).toFixed(8),0)}},{key:"renderSubmitButton",value:function(){var e=!0===this.state.valueCheck&&(_t.BTC.full(this.state)||null!==this.state.ensResolvedAddress);return this.state.isLoading?l.a.createElement(E.a,{type:"primary",style:{margin:"30px 0 0 0"},loading:!0},"Waiting..."):e?l.a.createElement(E.a,{type:"primary",onClick:this.submit,style:{margin:"30px 0 0 0"}},"Send"):l.a.createElement(E.a,{type:"primary",style:{margin:"30px 0 0 0"},disabled:!0},"Send")}},{key:"renderBalance",value:function(){var e=this.props.session.getBtcBalance()/_.constants.SATS_TO_BTC;return l.a.createElement(u.a,{justify:"center",style:{margin:"0 0 20px 0"}},l.a.createElement(ot.a,{title:"Balance",value:"".concat(e," BTC")}))}},{key:"renderCard",value:function(){return!!this.props.session.addresses.BTC&&this.props.session.addresses.BTC.length>0?l.a.createElement("div",null,this.renderBalance(),l.a.createElement("div",null,this.renderRecipientLabel()),l.a.createElement("div",{style:{margin:"20px 0 0 0"}},this.renderValueLabel()),l.a.createElement("div",{style:{margin:"20px 0 0 0"}},this.renderExtra()),this.renderSubmitButton()):l.a.createElement("div",null,l.a.createElement("p",null,"No addresses found from your Lattice. If you have your wallet setup, please try logging out and reconnecting."),l.a.createElement(bt.a,{image:bt.a.PRESENTED_IMAGE_SIMPLE}))}},{key:"render",value:function(){var e=l.a.createElement("center",null,this.renderBanner(),l.a.createElement(y.a,{title:"Send BTC",bordered:!0},this.renderCard()));return l.a.createElement(f,{content:e})}}]),n}(l.a.Component);At.contextType=h.a;var Bt=At,Pt=n(677),It=n(632),wt=v.a.Search,jt=v.a.TextArea,Rt=function(e){Object(s.a)(n,e);var t=Object(c.a)(n);function n(e){var a,i;return Object(r.a)(this,n),(i=t.call(this,e)).state={address:null,windowWidth:null===(a=document.getElementById("main-content-inner"))||void 0===a?void 0:a.offsetWidth},i.updateWidth=i.updateWidth.bind(Object(p.a)(i)),i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.updateDisplayAddress(),this.props.session&&this.props.session.getBtcWalletData(),window.addEventListener("resize",this.updateWidth)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWidth)}},{key:"updateWidth",value:function(){var e;this.setState({windowWidth:null===(e=document.getElementById("main-content-inner"))||void 0===e?void 0:e.offsetWidth})}},{key:"updateDisplayAddress",value:function(){var e=this.props.session.getBtcDisplayAddress();e&&this.setState({address:e})}},{key:"copyAddress",value:function(){document.getElementById("address-data").select(),document.execCommand("copy")}},{key:"renderAddrBox",value:function(){return this.context.isMobile?l.a.createElement("div",null,l.a.createElement(jt,{id:"address-data",value:this.state.address,autoSize:{minRows:1,maxRows:3},style:{margin:"30px 0 0 0",textAlign:"center"}}),l.a.createElement(E.a,{type:"primary",style:{margin:"20px 0 0 0"},onClick:this.copyAddress},"Copy ",l.a.createElement(Pt.a,null))):l.a.createElement(wt,{type:"text",id:"address-data",value:this.state.address,enterButton:l.a.createElement(Pt.a,null),onSearch:this.copyAddress,style:{margin:"30px 0 0 0",textAlign:"center"}})}},{key:"renderCard",value:function(){if(this.state.address){var e;if(!Object(_.validateBtcAddr)(this.state.address))return;var t=null===(e=document.getElementById("receive-card"))||void 0===e?void 0:e.offsetWidth,n=Math.min(300,.8*t);return l.a.createElement("div",null,l.a.createElement(u.a,{justify:"center"},l.a.createElement(It,{value:this.state.address,size:n,style:{margin:"30px 0 0 0"}})),l.a.createElement(u.a,{justify:"center"},this.renderAddrBox()))}return l.a.createElement("div",null,l.a.createElement("p",null,"No addresses found"),l.a.createElement(bt.a,{image:bt.a.PRESENTED_IMAGE_SIMPLE}))}},{key:"render",value:function(){var e=l.a.createElement("center",null,l.a.createElement(y.a,{title:"Receive BTC",bordered:!0,id:"receive-card"},l.a.createElement("center",null,this.renderCard())));return l.a.createElement(f,{content:e})}}]),n}(l.a.Component);Rt.contextType=h.a;var xt=Rt},642:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(45),s=n.n(i),c=(n(53),n(51)),o=n(34);var l=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.b,null,r.a.createElement(c.g,null)))};s.a.render(r.a.createElement(l,null),document.getElementById("root"))},8:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"constants",(function(){return s})),n.d(t,"fetchBtcUtxos",(function(){return d})),n.d(t,"fetchBtcTxs",(function(){return f})),n.d(t,"fetchBtcPrice",(function(){return p})),n.d(t,"broadcastBtcTx",(function(){return E})),n.d(t,"harden",(function(){return v})),n.d(t,"getBtcPurpose",(function(){return y})),n.d(t,"getBtcNumTxBytes",(function(){return C})),n.d(t,"buildBtcTxReq",(function(){return T})),n.d(t,"validateBtcAddr",(function(){return _})),n.d(t,"toHexStr",(function(){return S})),n.d(t,"filterUniqueObjects",(function(){return O}));var a=n(29),r=n(285),i=n(284).bech32,s={DEFAULT_APP_NAME:"Lattice Manager",ENV:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_ENV||"prod",BASE_SIGNING_URL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BASE_SIGNING_URL||"https://signing.gridpl.us",BTC_PROD_DATA_API:"https://blockchain.info",BTC_BROADCAST_ENDPOINT:"https://blockstream.info/api/tx",HARDENED_OFFSET:2147483648,ASYNC_SDK_TIMEOUT:6e4,ADDRESSES_PER_PAGE:10,CONTRACTS_PER_PAGE:10,SHORT_TIMEOUT:3e4,BTC_COIN:parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BTC_COIN)||2147483648,SATS_TO_BTC:Math.pow(10,8),BTC_MAIN_GAP_LIMIT:20,BTC_CHANGE_GAP_LIMIT:1,BTC_ADDR_BLOCK_LEN:10,BTC_CHANGE_ADDR_BLOCK_LEN:1,BTC_DEFAULT_FEE_RATE:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BTC_DEFAULT_FEE_RATE||10,BTC_TX_BASE_URL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BTC_TX_BASE_URL||"https://www.blockchain.com/btc/tx",PAGE_SIZE:20,CONTRACT_PAGE_SIZE:6,LOST_PAIRING_ERR:"NOT_PAIRED",LOST_PAIRING_MSG:"Cannot find Lattice connection. Please re-connect.",BTC_TESTNET:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BTC_TESTNET||null,KEYRING_LOGOUT_MS:parseInt(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).KEYRING_LOGOUT_MS)||2592e6,KEYRING_DATA_PATH:"gridplus_web_wallet_keyring_logins",ABI_PACK_URL:"https://gridplus.github.io/abi-pack-framework",LATTICE_CERT_SIGNER:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_LATTICE_CERT_SIGNER||"0477816e8e83bb17c4309cc2e5aa134c573a5943154940095a423149f7cc0384ad52d33f1b4cd89c967bf211c039202df3a7899cb7543de4738c96a81cfde4b117",CONTRACTS_HELP_LINK:"https://docs.gridplus.io/gridplus-web-wallet/use-ethereum-smart-contract-abi-function-definitions",TAGS_HELP_LINK:"https://docs.gridplus.io/gridplus-web-wallet/address-tags",PERMISSIONS_HELP_LINK:"https://docs.gridplus.io/gridplus-web-wallet/how-to-set-and-use-spending-limits",BTC_WALLET_STORAGE_KEY:"btc_wallet",BTC_PURPOSE_NONE:-1,BTC_PURPOSE_NONE_STR:"Hide BTC Wallet",BTC_PURPOSE_LEGACY:2147483692,BTC_PURPOSE_LEGACY_STR:"Legacy (1)",BTC_PURPOSE_WRAPPED_SEGWIT:2147483697,BTC_PURPOSE_WRAPPED_SEGWIT_STR:"Wrapped Segwit (3)",BTC_PURPOSE_SEGWIT:2147483732,BTC_PURPOSE_SEGWIT_STR:"Segwit (bc1)",BTC_SEGWIT_NATIVE_V0_PREFIX:"bc",BTC_LEGACY_VERSION:0,BTC_WRAPPED_SEGWIT_VERSION:5,RATE_LIMIT:1e3,GET_ABI_URL:"https://api.etherscan.io/api?module=contract&action=getabi&address=",DEFAULT_CONTRACT_NETWORK:"ethereum",CONTRACT_NETWORKS:{ethereum:{label:"Ethereum",url:"https://etherscan.io",baseUrl:"https://api.etherscan.io",apiRoute:"api?module=contract&action=getabi&address="},arbitrum:{label:"Arbitrum",url:"https://arbiscan.io",baseUrl:"https://api.arbiscan.io",apiRoute:"api?module=contract&action=getabi&address="},polygon:{label:"Polygon",url:"https://polygonscan.com",baseUrl:"https://api.polygonscan.com",apiRoute:"api?module=contract&action=getabi&address="},optimism:{label:"Optimism",url:"https://optimistic.etherscan.io",baseUrl:"https://api-optimistic.etherscan.io",apiRoute:"api?module=contract&action=getabi&address="},binance:{label:"Binance",url:"https://bscscan.com/",baseUrl:"https://api.bscscan.com",apiRoute:"api?module=contract&action=getabi&address="},avalanche:{label:"Avalanche",url:"https://snowtrace.io",baseUrl:"https://api.snowtrace.io",apiRoute:"api?module=contract&action=getabi&address="}}},c={BTC_DEV_DATA_API:"https://blockstream.info/testnet/api",BTC_BROADCAST_ENDPOINT:"https://blockstream.info/testnet/api/tx",BASE_SIGNING_URL:"https://signing.staging-gridpl.us",BTC_COIN:2147483649,BTC_DEFAULT_FEE_RATE:10,BTC_TX_BASE_URL:"https://www.blockchain.com/btc-testnet/tx",BTC_TESTNET:"Testnet3",LATTICE_CERT_SIGNER:"045cfdf77a00b4b6b4a5b8bb26b5497dbc7a4d01cbefd7aaeaf5f6f8f8865976e7941ab0ec1651209c444009fd48d925a17de5040ba47eaf3f5b51720dd40b2f9d",BTC_SEGWIT_NATIVE_V0_PREFIX:"tb",BTC_LEGACY_VERSION:111,BTC_WRAPPED_SEGWIT_VERSION:196};function o(e,t,n){fetch(e,t).then((function(e){return e.json()})).then((function(e){return n(null,e)})).catch((function(e){return n(e)}))}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(0===e.length)return t(null,n);for(var r=20,i=50,c=e.slice(0,r),u="".concat(s.BTC_PROD_DATA_API,"/unspent?active="),d=0;d<c.length;d++)u=0===d?"".concat(u).concat(c[d]):"".concat(u,"|").concat(c[d]);u="".concat(u,"&limit=").concat(i,"&confirmations=1"),a>0&&(u="".concat(u,"&offset=").concat(a)),o(u,null,(function(c,o){return c?t(c):(o.unspent_outputs.forEach((function(e){e.confirmations>0&&n.push({id:e.tx_hash_big_endian,vout:e.tx_output_n,value:e.value,address:b(e.script)})})),o.unspent_outputs.length>=i?setTimeout((function(){l(e,t,n,a+i)}),s.RATE_LIMIT):(e=e.slice(r),void setTimeout((function(){l(e,t,n,0)}),s.RATE_LIMIT)))}))}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=e.pop(),r="".concat(s.BTC_DEV_DATA_API,"/address/").concat(a,"/utxo");o(r,null,(function(r,i){return r?t(r):(i.forEach((function(e){e.status.confirmed&&n.push({id:e.txid,vout:e.vout,value:e.value,address:a})})),0===e.length?t(null,n):void setTimeout((function(){u(e,t,n)}),s.RATE_LIMIT))}))}function d(e,t){if(!e)return t("Cannot fetch UTXOs - bad input");if(e.length<1)return t(null,[]);var n=JSON.parse(JSON.stringify(e));(s.BTC_DEV_DATA_API?u:l)(n,t)}function h(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(0===e.length)return n(null,t);var i="".concat(s.BTC_PROD_DATA_API,"/multiaddr?active="),c=r&&1===e.length;c&&(i="".concat(s.BTC_PROD_DATA_API,"/rawaddr/"));for(var l=20,u=50,d=e.slice(0,l),m=0;m<d.length;m++)i=0===m?"".concat(i).concat(d[m]):"".concat(i,"|").concat(d[m]);i=c?"".concat(i,"?limit=").concat(u):"".concat(i,"&n=").concat(u),a>0&&(i="".concat(i,"&offset=").concat(a)),o(i,null,(function(r,i){if(r)return n(r);var c=0;if(i.txs.forEach((function(e){var n={timestamp:1e3*e.time,confirmed:!!e.block_index,id:e.hash,fee:e.fee,inputs:[],outputs:[]};e.inputs.forEach((function(e){n.inputs.push({addr:e.prev_out.addr,value:e.prev_out.value})})),e.out.forEach((function(e){n.outputs.push({addr:e.addr,value:e.value})})),n.confirmed||(n.timestamp=-1),t.every((function(e){return e.id!==n.id}))&&(t.push(n),c+=1)})),c>=u)return setTimeout((function(){h(e,t,n,a+u,!1)}),s.RATE_LIMIT);e=e.slice(l),setTimeout((function(){h(e,t,n,0,!1)}),s.RATE_LIMIT)}))}function m(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=e.pop(),i="".concat(s.BTC_DEV_DATA_API,"/address/").concat(r,"/txs");a&&(i="".concat(i,"/chain/").concat(a)),o(i,null,(function(a,i){if(a)return n(a);var c=[],o=0;return i.forEach((function(e){var t={timestamp:1e3*e.status.block_time,confirmed:e.status.confirmed,id:e.txid,fee:e.fee,inputs:[],outputs:[]};e.vin.forEach((function(e){t.inputs.push({addr:e.prevout.scriptpubkey_address,value:e.prevout.value})})),e.vout.forEach((function(e){t.outputs.push({addr:e.scriptpubkey_address,value:e.value})})),t.confirmed||(t.timestamp=-1),c.push(t),t.confirmed&&(o+=1)})),t=t.concat(c),o>=25?(e.push(r),m(e,t,n,t[o-1].id)):0===e.length?n(null,t):void setTimeout((function(){m(e,t,n)}),s.RATE_LIMIT)}))}function f(e,t,n){if(!e)return n("Cannot fetch transactions - bad input");if(e.length<1)return n(null,[]);var a=JSON.parse(JSON.stringify(e));(s.BTC_DEV_DATA_API?m:h)(a,t,n)}function p(e){o("https://api.blockchain.com/v3/exchange/tickers/BTC-USD",null,(function(t,n){return t?e(t):n&&n.last_trade_price?e(null,n.last_trade_price):e("Invalid price data returned")}))}function E(e,t){var n={method:"POST",body:e};fetch(s.BTC_BROADCAST_ENDPOINT,n).then((function(e){return e.text()})).then((function(e){return t(null,e)})).catch((function(e){return t(e)}))}function v(e){return e+2147483648}function g(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(a>=e.length)return-1;r+=e[a].value;var i=a+1,s=C(i),c=Math.floor(n*s);return r>=t+c?i:g(e,t,n,a=i,r)}function b(t){var n=y();if(n===s.BTC_PURPOSE_SEGWIT){var a=s.BTC_SEGWIT_NATIVE_V0_PREFIX,c=e.from(t,"hex").slice(-20),o=i.toWords(c);return o.unshift(0),i.encode(a,o)}if(n===s.BTC_PURPOSE_WRAPPED_SEGWIT){var l=s.BTC_WRAPPED_SEGWIT_VERSION,u=e.from(t,"hex").slice(2,22);return r.encode(e.concat([e.from([l]),u]))}if(n===s.BTC_PURPOSE_LEGACY){var d=s.BTC_LEGACY_VERSION,h=e.from(t,"hex").slice(3,23);return r.encode(e.concat([e.from([d]),h]))}}function y(){var e=a.a.getSettings();return e.btcPurpose?e.btcPurpose:s.BTC_PURPOSE_NONE}function C(e){var t,n,a,r=y();r===s.BTC_PURPOSE_LEGACY?(t=148,n=32,a=0):r===s.BTC_PURPOSE_SEGWIT?(t=91,n=32,a=107):(t=67.75,n=31,a=107);var i=r===s.BTC_PURPOSE_LEGACY?0:.75;return 3*i+(10+i+t*e+2*n)+a*e}function T(e,t,n,a,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.BTC_DEFAULT_FEE_RATE,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!a||!r||a.length<1||r.length<1)return{error:"No addresses (or change addresses). Please wait to sync."};var o=Math.round(Number(t)*s.SATS_TO_BTC),l=c?n.length:g(n,o,i);if(l<0)return{error:"Balance too low."};if(l>n.length)return{error:"Failed to build transaction."};for(var u=C(l),d=Math.floor(u*i),h=[y(),s.BTC_COIN,s.HARDENED_OFFSET],m=[],f=0;f<l;f++){var p=n[f],E=null;if(a.indexOf(p.address)>-1)E=h.concat([0,a.indexOf(p.address)]);else{if(!(r.indexOf(p.address)>-1))return{error:"Failed to find holder of UTXO. Syncing issue likely."};E=h.concat([1,r.indexOf(p.address)])}var v={txHash:p.id,value:p.value,index:p.vout,signerPath:E};m.push(v)}var b={prevOuts:m,recipient:e,value:o,fee:d,changePath:h.concat([1,r.length-1])};return{currency:"BTC",data:b}}function _(e){if(""===e)return null;try{return r.decode(e),!0}catch(t){try{return i.decode(e),!0}catch(t){return!1}}}function S(e){var t=e.toString(16),n=t.length%2===0?t:"0".concat(t);return"0x".concat(n)}function O(e,t){var n=[];return JSON.parse(JSON.stringify(e)).reverse().forEach((function(e){var a=!1;n.forEach((function(n){var r=0;t.forEach((function(t){n[t]===e[t]&&(r+=1)})),r>=t.length&&(a=!0)})),a||n.push(e)})),n.reverse()}a.a.getSettings().devLattice&&Object.keys(c).forEach((function(e){s[e]=c[e]}))}.call(this,n(20).Buffer)}},[[377,1,2]]]);
//# sourceMappingURL=main.976f5c12.chunk.js.map